function compare(e,i){if(assert.equal(typeof e,typeof i,"types didn't match"),"object"!=typeof e||null===e)assert.strictEqual(e,i,"result doesn't equal expected");else for(var t in e)assert.ok(t in i,"result didn't contain property "+t),compare(e[t],i[t])}var fs=require("fs"),path=require("path"),assert=require("assert"),Parser=require("htmlparser2").Parser,Handler=require("./"),basePath=path.resolve(__dirname,"tests"),chunkSize=5;fs.readdirSync(basePath).filter(RegExp.prototype.test,/\.json$/).map(function(e){return path.resolve(basePath,e)}).map(require).forEach(function(e){console.log("Testing:",e.name);for(var i=new Handler(function(i,t){assert.ifError(i),compare(e.expected,t)},e.options.handler),t=e.html,s=new Parser(i,e.options.parser),a=0;t.length>a;a+=chunkSize)s.write(t.substring(a,a+chunkSize));s.done(),s.parseComplete(t)}),console.log("\nAll tests passed!");