var Overlay=require("../overlay.reel").Overlay,Promise=require("../../core/promise").Promise,CLASS_PREFIX="montage-ModalOverlay";exports.ModalOverlay=Overlay.specialize({constructor:{value:function(){this.super()}},enterDocument:{value:function(e){var t;this.super(e),e&&(t=this.element.ownerDocument.body,t.appendChild(this.modalMaskElement))}},_queue:{value:[]},_showPromise:{value:null},_dismissOnExternalInteraction:{value:!1},hasModalMask:{value:!0},show:{value:function(){var e,t=this._queue,n=t.indexOf(this);return-1===n?(0===t.length?(this.super(),e=Promise.resolve()):(this._showPromise=Promise.defer(),e=this._showPromise.promise),t.push(this)):(0===n&&(this._showPromise=Promise.defer(),t.push(this)),e=this._showPromise.promise),e}},hide:{value:function(){var e,t=this._queue,n=t.indexOf(this);0===n?(t.shift(),this.super(),t.length>0&&(e=t[0],e._showPromise.resolve(),Overlay.prototype.show.call(e))):n>0&&(t.splice(n,1),this._showPromise.reject())}},draw:{value:function(){this.super(),this._isShown&&this.hasModalMask?this.modalMaskElement.classList.add(CLASS_PREFIX+"-modalMask--visible"):this.modalMaskElement.classList.remove(CLASS_PREFIX+"-modalMask--visible")}}});