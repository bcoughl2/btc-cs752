montageDefine("45fb404","deque",{dependencies:["./shim-object","./generic-collection","./generic-order","./listen/range-changes"],factory:function(e,t,n){"use strict";function i(e,t){return this instanceof i?(this.capacity=this.snap(t),this.init(),this.length=0,this.front=0,this.addEach(e),void 0):new i(e,t)}function r(e,t,n,i,r){for(var a=0;r>a;++a)n[a+i]=e[a+t]}function a(e){return e>>>=0,e-=1,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e+1}e("./shim-object");var s=e("./generic-collection"),o=e("./generic-order"),o=e("./generic-order"),l=e("./listen/range-changes");n.exports=i,Object.addEach(i.prototype,s.prototype),Object.addEach(i.prototype,o.prototype),Object.addEach(i.prototype,l.prototype),i.prototype.maxCapacity=0|1<<30,i.prototype.minCapacity=16,i.prototype.constructClone=function(e){return new this.constructor(e,this.capacity)},i.prototype.add=function(e){this.push(e)},i.prototype.push=function(e){var t=arguments.length,n=this.length;if(this.dispatchesRangeChanges){for(var i=Array(t),r=0;t>r;++r)i[r]=arguments[r];var a=[];this.dispatchBeforeRangeChange(i,a,n)}if(t>1){var s=this.capacity;if(n+t>s)for(var r=0;t>r;++r){this.ensureCapacity(n+1);var o=this.front+n&this.capacity-1;this[o]=arguments[r],n++,this.length=n}else{for(var o=this.front,r=0;t>r;++r)this[o+n&s-1]=arguments[r],o++;this.length=n+t}}else if(1===t){this.ensureCapacity(n+1);var l=this.front+n&this.capacity-1;this[l]=e,this.length=n+1}return this.dispatchesRangeChanges&&this.dispatchRangeChange(i,a,n),this.length},i.prototype.pop=function(){var e=this.length;if(0!==e){var t=this.front+e-1&this.capacity-1,n=this[t];return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([],[n],e-1),this[t]=void 0,this.length=e-1,this.dispatchesRangeChanges&&this.dispatchRangeChange([],[n],e-1),n}},i.prototype.shift=function(){if(0!==this.length){var e=this.front,t=this[e];return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([],[t],0),this[e]=void 0,this.front=e+1&this.capacity-1,this.length--,this.dispatchesRangeChanges&&this.dispatchRangeChange([],[t],0),t}},i.prototype.unshift=function(e){var t=this.length,n=arguments.length;if(this.dispatchesRangeChanges){for(var i=Array(n),r=0;n>r;++r)i[r]=arguments[r];var a=[];this.dispatchBeforeRangeChange(i,a,0)}if(n>1){var s=this.capacity;if(t+n>s)for(var r=n-1;r>=0;r--){this.ensureCapacity(t+1);var s=this.capacity,o=(this.front-1&s-1^s)-s;this[o]=arguments[r],t++,this.front=o,this.length=t}else{for(var l=this.front,r=n-1;r>=0;r--){var o=(l-1&s-1^s)-s;this[o]=arguments[r],l=o}this.front=l,this.length=t+n}}else if(1===n){this.ensureCapacity(t+1);var s=this.capacity,o=(this.front-1&s-1^s)-s;this[o]=e,this.length=t+1,this.front=o}return this.dispatchesRangeChanges&&this.dispatchRangeChange(i,a,0),this.length},i.prototype.clear=function(){this.length=0,this.front=0,this.init()},i.prototype.ensureCapacity=function(e){e>this.capacity&&this.grow(this.snap(1.5*this.capacity+16))},i.prototype.grow=function(e){var t=this.front,n=this.capacity,i=Array(n),a=this.length;if(r(this,0,i,0,n),this.capacity=e,this.init(),this.front=0,n>=t+a)r(i,t,this,0,a);else{var s=a-(t+a&n-1);r(i,t,this,0,s),r(i,0,this,s,a-s)}},i.prototype.init=function(){for(var e=0;this.capacity>e;++e)this[e]="nil"},i.prototype.snap=function(e){return"number"!=typeof e?this.minCapacity:a(Math.min(this.maxCapacity,Math.max(this.minCapacity,e)))},i.prototype.one=function(){return this.length>0?this[this.front]:void 0},i.prototype.peek=function(){return 0!==this.length?this[this.front]:void 0},i.prototype.poke=function(e){0!==this.length&&(this[this.front]=e)},i.prototype.peekBack=function(){var e=this.length;if(0!==e){var t=this.front+e-1&this.capacity-1;return this[t]}},i.prototype.pokeBack=function(e){var t=this.length;if(0!==t){var n=this.front+t-1&this.capacity-1;this[n]=e}},i.prototype.get=function(e){return e!==(0|e)||(0>e&&(e+=this.length),0>e||e>=this.length)?void 0:this[this.front+e&this.capacity-1]},i.prototype.indexOf=function(e,t){null==t&&(t=0),0>t&&(t+=this.length);for(var n=this.capacity-1;this.length>t;t++){var i=this.front+t&n;if(this[i]===e)return t}return-1},i.prototype.lastIndexOf=function(e,t){null==t&&(t=this.length-1),0>t&&(t+=this.length);for(var n=this.capacity-1;t>=0;t--){var i=this.front+t&n;if(this[i]===e)return t}return-1},i.prototype.find=function(e,t,n){t=t||Object.equals,null==n&&(n=0),0>n&&(n+=this.length);for(var i=this.capacity-1;this.length>n;n++){var r=this.front+n&i;if(t(e,this[r]))return n}return-1},i.prototype.findLast=function(e,t,n){t=t||Object.equals,null==n&&(n=this.length-1),0>n&&(n+=this.length);for(var i=this.capacity-1;n>=0;n--){var r=this.front+n&i;if(t(e,this[r]))return n}return-1},i.prototype.has=function(e,t){t=t||Object.equals;for(var n=this.capacity-1,i=0;this.length>i;i++){var r=this.front+i&n;if(this[r]===e)return!0}return!1},i.prototype.reduce=function(e,t){for(var n=arguments[2],i=this.capacity-1,r=0;this.length>r;r++){var a=this.front+r&i;t=e.call(n,t,this[a],r,this)}return t},i.prototype.reduceRight=function(e,t){for(var n=arguments[2],i=this.capacity-1,r=this.length-1;r>=0;r--){var a=this.front+r&i;t=e.call(n,t,this[a],r,this)}return t}}});