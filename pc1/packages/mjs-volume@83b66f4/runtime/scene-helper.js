require("runtime/dependencies/gl-matrix");var Montage=require("montage").Montage,Uuid=require("montage/core/uuid").Uuid,glTFScene=require("runtime/glTF-scene").glTFScene,glTFNode=require("runtime/glTF-node").glTFNode,Scene=require("runtime/scene").Scene,Node=require("runtime/node").Node,SceneRenderer=require("runtime/scene-renderer").SceneRenderer,glTFMaterial=require("runtime/glTF-material").glTFMaterial,Utilities=require("runtime/utilities").Utilities,Projection=require("runtime/projection").Projection,Camera=require("runtime/camera").Camera,BBox=require("runtime/utilities").BBox,Set=require("collections/set"),Material=require("runtime/material").Material,SceneHelper=exports.SceneHelper=Object.create(Object.prototype,{getGLTFViewPoints:{value:function(e){var t=[],i=e.glTFElement.rootNode;return i.apply(function(e){return e.cameras&&e.cameras.length&&(t=t.concat(e)),null},!0,null),t}},getViewPoints:{value:function(e){var t=this.getGLTFViewPoints(e),i=[];return t.forEach(function(t){var n=Montage.create(Node);n.scene=e,n.id=t.baseId,i.push(n)},this),i}},createGLTFNodeIncludingCamera:{value:function(e){var t=Object.create(Projection);t.initWithDescription({type:"perspective",perspective:{yfov:45,aspectRatio:1,znear:.1,zfar:100}});var i=Object.create(Camera).init();i.projection=t;var n=Object.create(glTFNode).init();return i.name=n.name=e,n.id=Uuid.generate(),n.baseId=n.id,n.cameras.push(i),n}},createNodeIncludingCamera:{value:function(e,t){var i=SceneHelper.createGLTFNodeIncludingCamera(e),n=t.glTFElement;n.ids[i.baseId]=i;var r=Montage.create(Node);return r.scene=t,r.id=i.baseId,r}},getMaterialsFromNode:{value:function(e){var t=e.glTFElement,i=new Set,n=e.scene;return null!=t.meshes&&t.meshes.forEach(function(e){e.primitives&&e.primitives.forEach(function(e){var t,r=e.material;null==r.component3D?(t=Montage.create(Material),t.scene=n,t.id=r.baseId,n.glTFElement.ids[r.baseId]=r,r.component3D=t):t=r.component3D,i.add(t)},this)},this),i}},createNodeFromGlTFElementIfNeeded:{value:function(e,t){if(null!=e.component3D)return e.component3D;var i=new Node;return t.glTFElement.ids[e.baseId]=e,i.scene=t,i.id=e.baseId,e.component3D=i,i}},createMaterialFromGlTFElementIfNeeded:{value:function(e,t){if(null!=e.component3D)return e.component3D;var i=new Material;return t.glTFElement.ids[e.baseId]=e,i.scene=t,i.id=e.baseId,e.component3D=i,i}},getGLTFCamera:{value:function(e){var t=null;if(e.glTFElement){var i=e.glTFElement;null!=i.cameras&&i.cameras.length>0&&(t=i.cameras[0])}return t}}});