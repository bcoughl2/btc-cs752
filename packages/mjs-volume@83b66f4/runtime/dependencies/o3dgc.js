exports.o3dgc=function(){"use strict";function e(){var e,t,n;return t=new ArrayBuffer(4),e=new Uint32Array(t),n=new Uint8Array(t),e[0]=1,1===n[0]?u.O3DGC_LITTLE_ENDIAN:u.O3DGC_BIG_ENDIAN}function t(e,t,n,i){var r,a,s,o,l,c,h;for(r=-1,a=!1,o=t.m_value,l=0,s=l;o>s;++s){if(e.Equal(n[s].m_id)){a=!0;break}if(e.Less(n[s].m_id)){for(t.m_value<u.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS&&++t.m_value,c=t.m_value-1;c>s;--c)for(n[c].m_id.m_a=n[c-1].m_id.m_a,n[c].m_id.m_b=n[c-1].m_id.m_b,n[c].m_id.m_c=n[c-1].m_id.m_c,h=0;i>h;++h)n[c].m_pred[h]=n[c-1].m_pred[h];n[s].m_id.m_a=e.m_a,n[s].m_id.m_b=e.m_b,n[s].m_id.m_c=e.m_c,r=s,a=!0;break}}return!a&&t.m_value<u.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS&&(r=t.m_value++,n[r].m_id.m_a=e.m_a,n[r].m_id.m_b=e.m_b,n[r].m_id.m_c=e.m_c),r}function n(e,t){var n,i,r;n=Math.abs(e.m_x),i=Math.abs(e.m_y),r=Math.abs(e.m_z),r>=n&&r>=i?e.m_z>=0?(t.m_z=0,t.m_x=e.m_x,t.m_y=e.m_y):(t.m_z=1,t.m_x=-e.m_x,t.m_y=-e.m_y):i>=n&&i>=r?e.m_y>=0?(t.m_z=2,t.m_x=e.m_z,t.m_y=e.m_x):(t.m_z=3,t.m_x=-e.m_z,t.m_y=-e.m_x):e.m_x>=0?(t.m_z=4,t.m_x=e.m_y,t.m_y=e.m_z):(t.m_z=5,t.m_x=-e.m_y,t.m_y=-e.m_z)}function i(e){return 0>e?-1-2*e:2*e}function r(e){return 1&e?-(e+1>>>1):e>>>1}function a(e,n,i,r,a,s,o,u){var c,h,d,m,f,p;for(p=new l.SC3DMCTriplet(-1,-1,-1),h=0;3>h;++h)if(m=e[3*n+h],i>m&&(p.m_a=-1,p.m_b=-1,p.m_c=m,d=t(p,r,a,s),-1!==d))for(c=m*u,f=0;s>f;++f)a[d].m_pred[f]=o[c+f]}function s(e,n,i,r,a,s,o,u,c,h){var d,m,f,p,v,_,g,b,y,w,D,S,C,E,T,O,M,I;if(d=3*n,I=new l.SC3DMCTriplet(-1,-1,-1),e[d]===i?(_=e[d+1],g=e[d+2]):e[d+1]===i?(_=e[d],g=e[d+2]):(_=e[d],g=e[d+1]),i>_&&i>g)for(S=c.Begin(_),C=c.End(_),E=S;C>E&&(T=h[E],!(0>T));++E){for(m=3*T,b=-1,O=!1,D=0;3>D;++D)y=e[m+D],y===g?O=!0:i>y&&y!==_&&(b=y);if(-1!==b&&O&&(g>_?(I.m_a=_,I.m_b=g):(I.m_a=g,I.m_b=_),I.m_c=-b-1,M=t(I,r,a,s),-1!==M))for(f=_*u,p=g*u,v=b*u,w=0;s>w;++w)a[M].m_pred[w]=o[f+w]+o[p+w]-o[v+w]}}function o(e,t,n,i,r){var a,s,o,u,c,h,d,m,f,p;for(p=new l.Vec3,m=new l.Vec3,f=new l.Vec3,o=3*i,s=0;o>s;++s)r[s]=0;for(u=0;t>u;++u)a=3*u,c=3*e[a],h=3*e[a+1],d=3*e[a+2],m.m_x=n[h]-n[c],m.m_y=n[h+1]-n[c+1],m.m_z=n[h+2]-n[c+2],f.m_x=n[d]-n[c],f.m_y=n[d+1]-n[c+1],f.m_z=n[d+2]-n[c+2],p.m_x=m.m_y*f.m_z-m.m_z*f.m_y,p.m_y=m.m_z*f.m_x-m.m_x*f.m_z,p.m_z=m.m_x*f.m_y-m.m_y*f.m_x,r[c]+=p.m_x,r[c+1]+=p.m_y,r[c+2]+=p.m_z,r[h]+=p.m_x,r[h+1]+=p.m_y,r[h+2]+=p.m_z,r[d]+=p.m_x,r[d+1]+=p.m_y,r[d+2]+=p.m_z}var l,u;return l={},u={},u.O3DGC_BINARY_STREAM_BITS_PER_SYMBOL0=7,u.O3DGC_BINARY_STREAM_MAX_SYMBOL0=127,u.O3DGC_BINARY_STREAM_BITS_PER_SYMBOL1=6,u.O3DGC_BINARY_STREAM_MAX_SYMBOL1=63,u.O3DGC_BINARY_STREAM_NUM_SYMBOLS_UINT32=5,u.O3DGC_BIG_ENDIAN=0,u.O3DGC_LITTLE_ENDIAN=1,u.O3DGC_MAX_DOUBLE=1.79769e308,u.O3DGC_MIN_LONG=-2147483647,u.O3DGC_MAX_LONG=2147483647,u.O3DGC_MAX_UCHAR8=255,u.O3DGC_MAX_TFAN_SIZE=256,u.O3DGC_MAX_ULONG=4294967295,u.O3DGC_SC3DMC_START_CODE=497,u.O3DGC_DV_START_CODE=498,u.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES=256,u.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES=256,u.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES=32,u.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS=2,u.O3DGC_SC3DMC_BINARIZATION_FL=0,u.O3DGC_SC3DMC_BINARIZATION_BP=1,u.O3DGC_SC3DMC_BINARIZATION_FC=2,u.O3DGC_SC3DMC_BINARIZATION_AC=3,u.O3DGC_SC3DMC_BINARIZATION_AC_EGC=4,u.O3DGC_SC3DMC_BINARIZATION_ASCII=5,u.O3DGC_STREAM_TYPE_UNKOWN=0,u.O3DGC_STREAM_TYPE_ASCII=1,u.O3DGC_STREAM_TYPE_BINARY=2,u.O3DGC_SC3DMC_NO_PREDICTION=0,u.O3DGC_SC3DMC_DIFFERENTIAL_PREDICTION=1,u.O3DGC_SC3DMC_XOR_PREDICTION=2,u.O3DGC_SC3DMC_ADAPTIVE_DIFFERENTIAL_PREDICTION=3,u.O3DGC_SC3DMC_CIRCULAR_DIFFERENTIAL_PREDICTION=4,u.O3DGC_SC3DMC_PARALLELOGRAM_PREDICTION=5,u.O3DGC_SC3DMC_SURF_NORMALS_PREDICTION=6,u.O3DGC_SC3DMC_ENCODE_MODE_QBCR=0,u.O3DGC_SC3DMC_ENCODE_MODE_SVA=1,u.O3DGC_SC3DMC_ENCODE_MODE_TFAN=2,u.O3DGC_DYNAMIC_VECTOR_ENCODE_MODE_LIFT=0,u.O3DGC_MIN_NEIGHBORS_SIZE=128,u.O3DGC_MIN_NUM_NEIGHBORS_SIZE=16,u.O3DGC_TFANS_MIN_SIZE_ALLOCATED_VERTICES_BUFFER=128,u.O3DGC_TFANS_MIN_SIZE_TFAN_SIZE_BUFFER=8,u.O3DGC_DEFAULT_VECTOR_SIZE=32,l.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_UNKOWN=0,l.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_POSITION=1,l.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_NORMAL=2,l.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_COLOR=3,l.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_TEXCOORD=4,l.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_WEIGHT=5,l.O3DGC_IFS_INT_ATTRIBUTE_TYPE_UNKOWN=0,l.O3DGC_IFS_INT_ATTRIBUTE_TYPE_INDEX=1,l.O3DGC_IFS_INT_ATTRIBUTE_TYPE_JOINT_ID=2,l.O3DGC_IFS_INT_ATTRIBUTE_TYPE_INDEX_BUFFER_ID=3,l.O3DGC_OK=0,l.O3DGC_ERROR_BUFFER_FULL=1,l.O3DGC_ERROR_CORRUPTED_STREAM=5,l.O3DGC_ERROR_NON_SUPPORTED_FEATURE=6,l.O3DGC_ERROR_AC=7,l.SC3DMCStats=function(){this.m_timeCoord=0,this.m_timeNormal=0,this.m_timeCoordIndex=0,this.m_timeFloatAttribute=new Float32Array(u.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES),this.m_timeIntAttribute=new Float32Array(u.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES),this.m_timeReorder=0,this.m_streamSizeCoord=0,this.m_streamSizeNormal=0,this.m_streamSizeCoordIndex=0,this.m_streamSizeFloatAttribute=new Uint32Array(u.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES),this.m_streamSizeIntAttribute=new Uint32Array(u.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES)},l.SC3DMCTriplet=function(e,t,n){this.m_a=e,this.m_b=t,this.m_c=n},l.SC3DMCTriplet.prototype.Less=function(e){var t;return t=this.m_c!==e.m_c?this.m_c<e.m_c:this.m_b!==e.m_b?this.m_b<e.m_b:this.m_a<e.m_a},l.SC3DMCTriplet.prototype.Equal=function(e){return this.m_c===e.m_c&&this.m_b===e.m_b&&this.m_a===e.m_a},l.SC3DMCPredictor=function(){this.m_id=new l.SC3DMCTriplet(-1,-1,-1),this.m_pred=new Float32Array(u.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES)},window.performance===void 0&&(window.performance={}),window.performance.now||(u.nowOffset=Date.now(),performance.timing&&performance.timing.navigationStart&&(u.nowOffset=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-u.nowOffset}),l.Timer=function(){this.m_start=0,this.m_end=0},l.Timer.prototype.Tic=function(){this.m_start=window.performance.now()},l.Timer.prototype.Toc=function(){this.m_end=window.performance.now()},l.Timer.prototype.GetElapsedTime=function(){return this.m_end-this.m_start},l.Vec3=function(e,t,n){this.m_x=e,this.m_y=t,this.m_z=n},l.Vec3.prototype.Set=function(e,t,n){this.m_x=e,this.m_y=t,this.m_z=n},l.Vec3.prototype.Sub=function(e,t){this.m_x=e.m_x-t.m_x,this.m_y=e.m_y-t.m_y,this.m_z=e.m_z-t.m_z},l.Vec3.prototype.Add=function(e,t){this.m_x=e.m_x+t.m_x,this.m_y=e.m_y+t.m_y,this.m_z=e.m_z+t.m_z},l.Vec3.prototype.SelfAdd=function(e){this.m_x+=e.m_x,this.m_y+=e.m_y,this.m_z+=e.m_z},l.Vec3.prototype.Cross=function(e,t){this.m_x=e.m_y*t.m_z-e.m_z*t.m_y,this.m_y=e.m_z*t.m_x-e.m_x*t.m_z,this.m_z=e.m_x*t.m_y-e.m_y*t.m_x},l.Vec3.prototype.GetNorm=function(){return Math.sqrt(this.m_x*this.m_x+this.m_y*this.m_y+this.m_z*this.m_z)},u.CubeToSphere={0:function(e,t){t.m_x=e.m_x,t.m_y=e.m_y,t.m_z=Math.sqrt(Math.max(0,1-t.m_x*t.m_x-t.m_y*t.m_y))},1:function(e,t){t.m_x=-e.m_x,t.m_y=-e.m_y,t.m_z=-Math.sqrt(Math.max(0,1-t.m_x*t.m_x-t.m_y*t.m_y))},2:function(e,t){t.m_z=e.m_x,t.m_x=e.m_y,t.m_y=Math.sqrt(Math.max(0,1-t.m_x*t.m_x-t.m_z*t.m_z))},3:function(e,t){t.m_z=-e.m_x,t.m_x=-e.m_y,t.m_y=-Math.sqrt(Math.max(0,1-t.m_x*t.m_x-t.m_z*t.m_z))},4:function(e,t){t.m_y=e.m_x,t.m_z=e.m_y,t.m_x=Math.sqrt(Math.max(0,1-t.m_y*t.m_y-t.m_z*t.m_z))},5:function(e,t){t.m_y=-e.m_x,t.m_z=-e.m_y,t.m_x=-Math.sqrt(Math.max(0,1-t.m_y*t.m_y-t.m_z*t.m_z))}},l.Iterator=function(){this.m_count=0},l.NumberRef=function(){this.m_value=0},l.BinaryStream=function(t){this.m_endianness=e(),this.m_buffer=t,this.m_stream=new Uint8Array(this.m_buffer),this.m_localBuffer=new ArrayBuffer(4),this.m_localBufferViewUChar8=new Uint8Array(this.m_localBuffer),this.m_localBufferViewFloat32=new Float32Array(this.m_localBuffer),this.m_localBufferViewUInt32=new Uint32Array(this.m_localBuffer)},l.BinaryStream.prototype.ReadFloat32Bin=function(e){return this.m_endianness===u.O3DGC_BIG_ENDIAN?(this.m_localBufferViewUChar8[3]=this.m_stream[e.m_count++],this.m_localBufferViewUChar8[2]=this.m_stream[e.m_count++],this.m_localBufferViewUChar8[1]=this.m_stream[e.m_count++],this.m_localBufferViewUChar8[0]=this.m_stream[e.m_count++]):(this.m_localBufferViewUChar8[0]=this.m_stream[e.m_count++],this.m_localBufferViewUChar8[1]=this.m_stream[e.m_count++],this.m_localBufferViewUChar8[2]=this.m_stream[e.m_count++],this.m_localBufferViewUChar8[3]=this.m_stream[e.m_count++]),this.m_localBufferViewFloat32[0]},l.BinaryStream.prototype.ReadUInt32Bin=function(e){return this.m_endianness===u.O3DGC_BIG_ENDIAN?(this.m_localBufferViewUChar8[3]=this.m_stream[e.m_count++],this.m_localBufferViewUChar8[2]=this.m_stream[e.m_count++],this.m_localBufferViewUChar8[1]=this.m_stream[e.m_count++],this.m_localBufferViewUChar8[0]=this.m_stream[e.m_count++]):(this.m_localBufferViewUChar8[0]=this.m_stream[e.m_count++],this.m_localBufferViewUChar8[1]=this.m_stream[e.m_count++],this.m_localBufferViewUChar8[2]=this.m_stream[e.m_count++],this.m_localBufferViewUChar8[3]=this.m_stream[e.m_count++]),this.m_localBufferViewUInt32[0]},l.BinaryStream.prototype.ReadUChar8Bin=function(e){return this.m_stream[e.m_count++]},l.BinaryStream.prototype.ReadUInt32ASCII=function(e){var t,n,i;for(t=0,n=0,i=0;u.O3DGC_BINARY_STREAM_NUM_SYMBOLS_UINT32>i;++i)t+=this.m_stream[e.m_count++]<<n>>>0,n+=u.O3DGC_BINARY_STREAM_BITS_PER_SYMBOL0;return t},l.BinaryStream.prototype.ReadFloat32ASCII=function(e){var t=this.ReadUInt32ASCII(e);return this.m_endianness===u.O3DGC_BIG_ENDIAN?(this.m_localBufferViewUChar8[3]=t&u.O3DGC_MAX_UCHAR8,t>>>=8,this.m_localBufferViewUChar8[2]=t&u.O3DGC_MAX_UCHAR8,t>>>=8,this.m_localBufferViewUChar8[1]=t&u.O3DGC_MAX_UCHAR8,t>>>=8,this.m_localBufferViewUChar8[0]=t&u.O3DGC_MAX_UCHAR8):(this.m_localBufferViewUChar8[0]=t&u.O3DGC_MAX_UCHAR8,t>>>=8,this.m_localBufferViewUChar8[1]=t&u.O3DGC_MAX_UCHAR8,t>>>=8,this.m_localBufferViewUChar8[2]=t&u.O3DGC_MAX_UCHAR8,t>>>=8,this.m_localBufferViewUChar8[3]=t&u.O3DGC_MAX_UCHAR8),this.m_localBufferViewFloat32[0]},l.BinaryStream.prototype.ReadIntASCII=function(e){return r(this.ReadUIntASCII(e))},l.BinaryStream.prototype.ReadUIntASCII=function(e){var t,n,i;if(i=this.m_stream[e.m_count++],i===u.O3DGC_BINARY_STREAM_MAX_SYMBOL0){t=0;do n=this.m_stream[e.m_count++],i+=n>>>1<<t>>>0,t+=u.O3DGC_BINARY_STREAM_BITS_PER_SYMBOL1;while(1&n)}return i},l.BinaryStream.prototype.ReadUCharASCII=function(e){return this.m_stream[e.m_count++]},l.BinaryStream.prototype.ReadFloat32=function(e,t){return t===u.O3DGC_STREAM_TYPE_ASCII?this.ReadFloat32ASCII(e):this.ReadFloat32Bin(e)},l.BinaryStream.prototype.ReadUInt32=function(e,t){return t===u.O3DGC_STREAM_TYPE_ASCII?this.ReadUInt32ASCII(e):this.ReadUInt32Bin(e)},l.BinaryStream.prototype.ReadUChar=function(e,t){return t===u.O3DGC_STREAM_TYPE_ASCII?this.ReadUCharASCII(e):this.ReadUChar8Bin(e)},l.BinaryStream.prototype.GetBuffer=function(e,t){return new Uint8Array(this.m_buffer,e.m_count,t)},u.O3DGC_AC_MIN_LENGTH=16777216,u.O3DGC_AC_MAX_LENGTH=4294967295,u.O3DGC_AC_BM_LENGTH_SHIFT=13,u.O3DGC_AC_BM_MAX_COUNT=1<<u.O3DGC_AC_BM_LENGTH_SHIFT>>>0,u.O3DGC_AC_DM_LENGTH_SHIFT=15,u.O3DGC_AC_DM_MAX_COUNT=1<<u.O3DGC_AC_DM_LENGTH_SHIFT>>>0,l.StaticBitModel=function(){this.m_bit0Prob=1<<u.O3DGC_AC_BM_LENGTH_SHIFT-1>>>0},l.StaticBitModel.prototype.SetProbability=function(e){this.m_bit0Prob=Math.floor(e*(1<<u.O3DGC_AC_BM_LENGTH_SHIFT>>>0))},l.AdaptiveBitModel=function(){this.m_updateCycle=4,this.m_bitsUntilUpdate=4,this.m_bit0Prob=1<<u.O3DGC_AC_BM_LENGTH_SHIFT-1>>>0,this.m_bit0Count=1,this.m_bitCount=2},l.AdaptiveBitModel.prototype.Reset=function(){this.m_updateCycle=4,this.m_bitsUntilUpdate=4,this.m_bit0Prob=1<<u.O3DGC_AC_BM_LENGTH_SHIFT-1>>>0,this.m_bit0Count=1,this.m_bitCount=2},l.AdaptiveBitModel.prototype.Update=function(){(this.m_bitCount+=this.m_updateCycle)>u.O3DGC_AC_BM_MAX_COUNT&&(this.m_bitCount=this.m_bitCount+1>>>1,this.m_bit0Count=this.m_bit0Count+1>>>1,this.m_bit0Count===this.m_bitCount&&++this.m_bitCount);var e=Math.floor(2147483648/this.m_bitCount);this.m_bit0Prob=this.m_bit0Count*e>>>31-u.O3DGC_AC_BM_LENGTH_SHIFT,this.m_updateCycle=5*this.m_updateCycle>>>2,this.m_updateCycle>64&&(this.m_updateCycle=64),this.m_bitsUntilUpdate=this.m_updateCycle},l.AdaptiveDataModel=function(){this.m_buffer={},this.m_distribution={},this.m_symbolCount={},this.m_decoderTable={},this.m_totalCount=0,this.m_updateCycle=0,this.m_symbolsUntilUpdate=0,this.m_dataSymbols=0,this.m_lastSymbol=0,this.m_tableSize=0,this.m_tableShift=0},l.AdaptiveDataModel.prototype.Update=function(){var e,t,n,i,r,a,s;if((this.m_totalCount+=this.m_updateCycle)>u.O3DGC_AC_DM_MAX_COUNT)for(this.m_totalCount=0,e=0;this.m_dataSymbols>e;++e)this.m_totalCount+=this.m_symbolCount[e]=this.m_symbolCount[e]+1>>>1;if(t=0,n=0,i=Math.floor(2147483648/this.m_totalCount),0===this.m_tableSize)for(r=0;this.m_dataSymbols>r;++r)this.m_distribution[r]=i*t>>>31-u.O3DGC_AC_DM_LENGTH_SHIFT,t+=this.m_symbolCount[r];else{for(r=0;this.m_dataSymbols>r;++r)for(this.m_distribution[r]=i*t>>>31-u.O3DGC_AC_DM_LENGTH_SHIFT,t+=this.m_symbolCount[r],s=this.m_distribution[r]>>>this.m_tableShift;s>n;)this.m_decoderTable[++n]=r-1;for(this.m_decoderTable[0]=0;this.m_tableSize>=n;)this.m_decoderTable[++n]=this.m_dataSymbols-1}this.m_updateCycle=5*this.m_updateCycle>>>2,a=this.m_dataSymbols+6<<3>>>0,this.m_updateCycle>a&&(this.m_updateCycle=a),this.m_symbolsUntilUpdate=this.m_updateCycle},l.AdaptiveDataModel.prototype.Reset=function(){var e;if(0!==this.m_dataSymbols){for(this.m_totalCount=0,this.m_updateCycle=this.m_dataSymbols,e=0;this.m_dataSymbols>e;++e)this.m_symbolCount[e]=1;this.Update(),this.m_symbolsUntilUpdate=this.m_updateCycle=this.m_dataSymbols+6>>>1}},l.AdaptiveDataModel.prototype.SetAlphabet=function(e){if(2>e||e>2048)return Console.log("invalid number of data symbols"),l.O3DGC_ERROR_AC;if(this.m_dataSymbols!==e)if(this.m_dataSymbols=e,this.m_lastSymbol=this.m_dataSymbols-1,this.m_dataSymbols>16){for(var t=3;this.m_dataSymbols>1<<t+2>>>0;)++t;this.m_tableSize=1<<t>>>0,this.m_tableShift=u.O3DGC_AC_DM_LENGTH_SHIFT-t,this.m_buffer=new ArrayBuffer(4*(2*this.m_dataSymbols+this.m_tableSize+2)),this.m_distribution=new Uint32Array(this.m_buffer,0,this.m_dataSymbols),this.m_symbolCount=new Uint32Array(this.m_buffer,4*this.m_dataSymbols,this.m_dataSymbols),this.m_decoderTable=new Uint32Array(this.m_buffer,8*this.m_dataSymbols,this.m_tableSize+2)}else this.m_tableSize=this.m_tableShift=0,this.m_buffer=new ArrayBuffer(8*this.m_dataSymbols),this.m_distribution=new Uint32Array(this.m_buffer,0,this.m_dataSymbols),this.m_symbolCount=new Uint32Array(this.m_buffer,4*this.m_dataSymbols,this.m_dataSymbols),this.m_decoderTable={};return this.Reset(),l.O3DGC_OK},l.ArithmeticDecoder=function(){this.m_codeBuffer={},this.m_acShift=0,this.m_base=0,this.m_value=0,this.m_length=0,this.m_bufferSize=0,this.m_mode=0},l.ArithmeticDecoder.prototype.SetBuffer=function(e,t){return 0===e?(Console.log("invalid codec buffer size"),l.O3DGC_ERROR_AC):0!==this.m_mode?(Console.log("cannot set buffer while encoding or decoding"),l.O3DGC_ERROR_AC):(this.m_bufferSize=e,this.m_codeBuffer=t,void 0)},l.ArithmeticDecoder.prototype.StartDecoder=function(){return 0!==this.m_mode?(Console.log("cannot start decoder"),l.O3DGC_ERROR_AC):0===this.m_bufferSize?(Console.log("no code buffer set"),l.O3DGC_ERROR_AC):(this.m_mode=2,this.m_length=u.O3DGC_AC_MAX_LENGTH,this.m_acShift=3,this.m_value=(this.m_codeBuffer[0]<<24|this.m_codeBuffer[1]<<16|this.m_codeBuffer[2]<<8|this.m_codeBuffer[3])>>>0,void 0)},l.ArithmeticDecoder.prototype.StopDecoder=function(){return 2!==this.m_mode?(Console.log("invalid to stop decoder"),l.O3DGC_ERROR_AC):(this.m_mode=0,void 0)},l.ArithmeticDecoder.prototype.GetBit=function(){this.m_length>>>=1;var e=this.m_value>=this.m_length;return e&&(this.m_value-=this.m_length),this.m_length<u.O3DGC_AC_MIN_LENGTH&&this.RenormDecInterval(),e},l.ArithmeticDecoder.prototype.GetBits=function(e){var t=Math.floor(this.m_value/(this.m_length>>>=e));return this.m_value-=this.m_length*t,this.m_length<u.O3DGC_AC_MIN_LENGTH&&this.RenormDecInterval(),t},l.ArithmeticDecoder.prototype.DecodeStaticBitModel=function(e){var t,n;return t=e.m_bit0Prob*(this.m_length>>>u.O3DGC_AC_BM_LENGTH_SHIFT),n=this.m_value>=t,n?(this.m_value-=t,this.m_length-=t):this.m_length=t,this.m_length<u.O3DGC_AC_MIN_LENGTH&&this.RenormDecInterval(),n},l.ArithmeticDecoder.prototype.DecodeAdaptiveBitModel=function(e){var t,n;return t=e.m_bit0Prob*(this.m_length>>>u.O3DGC_AC_BM_LENGTH_SHIFT),n=this.m_value>=t,n?(this.m_value-=t,this.m_length-=t):(this.m_length=t,++e.m_bit0Count),this.m_length<u.O3DGC_AC_MIN_LENGTH&&this.RenormDecInterval(),0===--e.m_bitsUntilUpdate&&e.Update(),n},l.ArithmeticDecoder.prototype.DecodeAdaptiveDataModel=function(e){var t,n,i,r,a,s,o,l;if(r=this.m_length,e.m_tableSize>0){for(s=Math.floor(this.m_value/(this.m_length>>>=u.O3DGC_AC_DM_LENGTH_SHIFT)),a=s>>>e.m_tableShift,n=e.m_decoderTable[a],t=e.m_decoderTable[a+1]+1;t>n+1;)l=n+t>>>1,e.m_distribution[l]>s?t=l:n=l;i=e.m_distribution[n]*this.m_length,n!==e.m_lastSymbol&&(r=e.m_distribution[n+1]*this.m_length)}else{i=n=0,this.m_length>>>=u.O3DGC_AC_DM_LENGTH_SHIFT,l=(t=e.m_dataSymbols)>>>1;do o=this.m_length*e.m_distribution[l],o>this.m_value?(t=l,r=o):(n=l,i=o);while((l=n+t>>>1)!==n)}return this.m_value-=i,this.m_length=r-i,this.m_length<u.O3DGC_AC_MIN_LENGTH&&this.RenormDecInterval(),++e.m_symbolCount[n],0===--e.m_symbolsUntilUpdate&&e.Update(!1),n},l.ArithmeticDecoder.prototype.ExpGolombDecode=function(e,t,n){var i,r,a;i=0,r=0;do a=this.DecodeAdaptiveBitModel(n),a&&(i+=1<<e>>>0,e++);while(a);for(;e--;)this.DecodeStaticBitModel(t)&&(r=(r|1<<e)>>>0);return i+r},l.ArithmeticDecoder.prototype.RenormDecInterval=function(){do this.m_value=(this.m_value<<8|this.m_codeBuffer[++this.m_acShift])>>>0,this.m_length=this.m_length<<8>>>0;while(this.m_length<u.O3DGC_AC_MIN_LENGTH)},l.ArithmeticDecoder.prototype.DecodeIntACEGC=function(e,t,n,i,a){var s=this.DecodeAdaptiveDataModel(e);return s===a&&(s+=this.ExpGolombDecode(i,t,n)),r(s)},l.ArithmeticDecoder.prototype.DecodeUIntACEGC=function(e,t,n,i,r){var a=this.DecodeAdaptiveDataModel(e);return a===r&&(a+=this.ExpGolombDecode(i,t,n)),a},l.FIFO=function(){this.m_data={},this.m_allocated=0,this.m_size=0,this.m_start=0,this.m_end=0},l.FIFO.prototype.Clear=function(){this.m_start=this.m_end=this.m_size=0},l.FIFO.prototype.GetAllocatedSize=function(){return this.m_allocated},l.FIFO.prototype.GetSize=function(){return this.m_size},l.FIFO.prototype.Allocate=function(e){return e>this.m_allocated&&(this.m_allocated=e,this.m_data=new Int32Array(this.m_allocated)),this.Clear(),l.O3DGC_OK},l.FIFO.prototype.PopFirst=function(){--this.m_size;var e=this.m_start++;return this.m_start===this.m_allocated&&(this.m_end=0),this.m_data[e]},l.FIFO.prototype.PushBack=function(e){--this.m_size,this.m_data[this.m_end]=e,++this.m_size,++this.m_end,this.m_end===this.m_allocated&&(this.m_end=0)},l.IndexedFaceSet=function(){this.m_nCoordIndex=0,this.m_nCoord=0,this.m_nNormal=0,this.m_numFloatAttributes=0,this.m_numIntAttributes=0,this.m_creaseAngle=30,this.m_ccw=!0,this.m_solid=!0,this.m_convex=!0,this.m_isTriangularMesh=!0,this.m_coordMin=new Float32Array(3),this.m_coordMax=new Float32Array(3),this.m_normalMin=new Float32Array(3),this.m_normalMax=new Float32Array(3),this.m_nFloatAttribute=new Uint32Array(u.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES),this.m_nIntAttribute=new Uint32Array(u.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES),this.m_dimFloatAttribute=new Uint32Array(u.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES),this.m_dimIntAttribute=new Uint32Array(u.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES),this.m_typeFloatAttribute=new Uint32Array(u.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES),this.m_typeIntAttribute=new Uint32Array(u.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES),this.m_minFloatAttributeBuffer=new ArrayBuffer(4*u.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES*u.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES),this.m_minFloatAttribute=new Float32Array(this.m_minFloatAttributeBuffer),this.m_maxFloatAttributeBuffer=new ArrayBuffer(4*u.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES*u.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES),this.m_maxFloatAttribute=new Float32Array(this.m_maxFloatAttributeBuffer),this.m_coordIndex={},this.m_coord={},this.m_normal={},this.m_floatAttribute=[],this.m_intAttribute=[]},l.IndexedFaceSet.prototype.GetNCoordIndex=function(){return this.m_nCoordIndex},l.IndexedFaceSet.prototype.GetNCoordIndex=function(){return this.m_nCoordIndex},l.IndexedFaceSet.prototype.GetNCoord=function(){return this.m_nCoord},l.IndexedFaceSet.prototype.GetNNormal=function(){return this.m_nNormal},l.IndexedFaceSet.prototype.GetNFloatAttribute=function(e){return this.m_nFloatAttribute[e]},l.IndexedFaceSet.prototype.GetNIntAttribute=function(e){return this.m_nIntAttribute[e]},l.IndexedFaceSet.prototype.GetNumFloatAttributes=function(){return this.m_numFloatAttributes},l.IndexedFaceSet.prototype.GetNumIntAttributes=function(){return this.m_numIntAttributes},l.IndexedFaceSet.prototype.GetCoordMinArray=function(){return this.m_coordMin},l.IndexedFaceSet.prototype.GetCoordMaxArray=function(){return this.m_coordMax},l.IndexedFaceSet.prototype.GetNormalMinArray=function(){return this.m_normalMin},l.IndexedFaceSet.prototype.GetNormalMaxArray=function(){return this.m_normalMax},l.IndexedFaceSet.prototype.GetFloatAttributeMinArray=function(e){return new Float32Array(this.m_minFloatAttributeBuffer,4*e*u.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES,this.GetFloatAttributeDim(e))},l.IndexedFaceSet.prototype.GetFloatAttributeMaxArray=function(e){return new Float32Array(this.m_maxFloatAttributeBuffer,4*e*u.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES,this.GetFloatAttributeDim(e))},l.IndexedFaceSet.prototype.GetFloatAttributeDim=function(e){return this.m_dimFloatAttribute[e]},l.IndexedFaceSet.prototype.GetIntAttributeDim=function(e){return this.m_dimIntAttribute[e]},l.IndexedFaceSet.prototype.GetFloatAttributeType=function(e){return this.m_typeFloatAttribute[e]},l.IndexedFaceSet.prototype.GetIntAttributeType=function(e){return this.m_typeIntAttribute[e]},l.IndexedFaceSet.prototype.GetFloatAttributeMax=function(e,t){return this.m_maxFloatAttribute[e*u.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES+t]},l.IndexedFaceSet.prototype.GetCreaseAngle=function(){return this.m_creaseAngle},l.IndexedFaceSet.prototype.GetCreaseAngle=function(){return this.m_creaseAngle},l.IndexedFaceSet.prototype.GetCCW=function(){return this.m_ccw},l.IndexedFaceSet.prototype.GetSolid=function(){return this.m_solid},l.IndexedFaceSet.prototype.GetConvex=function(){return this.m_convex},l.IndexedFaceSet.prototype.GetIsTriangularMesh=function(){return this.m_isTriangularMesh},l.IndexedFaceSet.prototype.GetCoordIndex=function(){return this.m_coordIndex},l.IndexedFaceSet.prototype.GetCoordIndex=function(){return this.m_coordIndex},l.IndexedFaceSet.prototype.GetCoord=function(){return this.m_coord},l.IndexedFaceSet.prototype.GetNormal=function(){return this.m_normal},l.IndexedFaceSet.prototype.GetFloatAttribute=function(e){return this.m_floatAttribute[e]},l.IndexedFaceSet.prototype.GetIntAttribute=function(e){return this.m_intAttribute[e]},l.IndexedFaceSet.prototype.SetNCoordIndex=function(e){this.m_nCoordIndex=e},l.IndexedFaceSet.prototype.SetNNormalIndex=function(){},l.IndexedFaceSet.prototype.SetNormalPerVertex=function(){},l.IndexedFaceSet.prototype.SetNFloatAttributeIndex=function(){},l.IndexedFaceSet.prototype.SetNIntAttributeIndex=function(){},l.IndexedFaceSet.prototype.SetFloatAttributePerVertex=function(){},l.IndexedFaceSet.prototype.SetIntAttributePerVertex=function(){},l.IndexedFaceSet.prototype.SetNCoord=function(e){this.m_nCoord=e},l.IndexedFaceSet.prototype.SetNNormal=function(e){this.m_nNormal=e},l.IndexedFaceSet.prototype.SetNumFloatAttributes=function(e){this.m_numFloatAttributes=e},l.IndexedFaceSet.prototype.SetNumIntAttributes=function(e){this.m_numIntAttributes=e},l.IndexedFaceSet.prototype.SetCreaseAngle=function(e){this.m_creaseAngle=e},l.IndexedFaceSet.prototype.SetCCW=function(e){this.m_ccw=e},l.IndexedFaceSet.prototype.SetSolid=function(e){this.m_solid=e},l.IndexedFaceSet.prototype.SetConvex=function(e){this.m_convex=e},l.IndexedFaceSet.prototype.SetIsTriangularMesh=function(e){this.m_isTriangularMesh=e},l.IndexedFaceSet.prototype.SetCoordMin=function(e,t){this.m_coordMin[e]=t},l.IndexedFaceSet.prototype.SetCoordMax=function(e,t){this.m_coordMax[e]=t},l.IndexedFaceSet.prototype.SetNormalMin=function(e,t){this.m_normalMin[e]=t},l.IndexedFaceSet.prototype.SetNormalMax=function(e,t){this.m_normalMax[e]=t},l.IndexedFaceSet.prototype.SetNFloatAttribute=function(e,t){this.m_nFloatAttribute[e]=t},l.IndexedFaceSet.prototype.SetNIntAttribute=function(e,t){this.m_nIntAttribute[e]=t},l.IndexedFaceSet.prototype.SetFloatAttributeDim=function(e,t){this.m_dimFloatAttribute[e]=t},l.IndexedFaceSet.prototype.SetIntAttributeDim=function(e,t){this.m_dimIntAttribute[e]=t},l.IndexedFaceSet.prototype.SetFloatAttributeType=function(e,t){this.m_typeFloatAttribute[e]=t},l.IndexedFaceSet.prototype.SetIntAttributeType=function(e,t){this.m_typeIntAttribute[e]=t},l.IndexedFaceSet.prototype.SetFloatAttributeMin=function(e,t,n){this.m_minFloatAttribute[e*u.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES+t]=n},l.IndexedFaceSet.prototype.SetFloatAttributeMax=function(e,t,n){this.m_maxFloatAttribute[e*u.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES+t]=n},l.IndexedFaceSet.prototype.SetCoordIndex=function(e){this.m_coordIndex=e},l.IndexedFaceSet.prototype.SetCoord=function(e){this.m_coord=e},l.IndexedFaceSet.prototype.SetNormal=function(e){this.m_normal=e},l.IndexedFaceSet.prototype.SetFloatAttribute=function(e,t){this.m_floatAttribute[e]=t},l.IndexedFaceSet.prototype.SetIntAttribute=function(e,t){this.m_intAttribute[e]=t},l.SC3DMCEncodeParams=function(){var e;for(this.m_numFloatAttributes=0,this.m_numIntAttributes=0,this.m_floatAttributeQuantBits=new Uint32Array(u.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES),this.m_floatAttributePredMode=new Uint32Array(u.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES),this.m_intAttributePredMode=new Uint32Array(u.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES),this.m_encodeMode=u.O3DGC_SC3DMC_ENCODE_MODE_TFAN,this.m_streamTypeMode=u.O3DGC_STREAM_TYPE_ASCII,this.m_coordQuantBits=14,this.m_normalQuantBits=8,this.m_coordPredMode=u.O3DGC_SC3DMC_PARALLELOGRAM_PREDICTION,this.m_normalPredMode=u.O3DGC_SC3DMC_SURF_NORMALS_PREDICTION,e=0;u.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES>e;++e)this.m_floatAttributePredMode[e]=u.O3DGC_SC3DMC_PARALLELOGRAM_PREDICTION;for(e=0;u.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES>e;++e)this.m_intAttributePredMode[e]=u.O3DGC_SC3DMC_DIFFERENTIAL_PREDICTION},l.SC3DMCEncodeParams.prototype.GetStreamType=function(){return this.m_streamTypeMode},l.SC3DMCEncodeParams.prototype.GetEncodeMode=function(){return this.m_encodeMode},l.SC3DMCEncodeParams.prototype.GetNumFloatAttributes=function(){return this.m_numFloatAttributes},l.SC3DMCEncodeParams.prototype.GetNumIntAttributes=function(){return this.m_numIntAttributes},l.SC3DMCEncodeParams.prototype.GetCoordQuantBits=function(){return this.m_coordQuantBits},l.SC3DMCEncodeParams.prototype.GetNormalQuantBits=function(){return this.m_normalQuantBits},l.SC3DMCEncodeParams.prototype.GetFloatAttributeQuantBits=function(e){return this.m_floatAttributeQuantBits[e]},l.SC3DMCEncodeParams.prototype.GetCoordPredMode=function(){return this.m_coordPredMode},l.SC3DMCEncodeParams.prototype.GetNormalPredMode=function(){return this.m_normalPredMode},l.SC3DMCEncodeParams.prototype.GetFloatAttributePredMode=function(e){return this.m_floatAttributePredMode[e]},l.SC3DMCEncodeParams.prototype.GetIntAttributePredMode=function(e){return this.m_intAttributePredMode[e]},l.SC3DMCEncodeParams.prototype.GetCoordPredMode=function(){return this.m_coordPredMode},l.SC3DMCEncodeParams.prototype.GetNormalPredMode=function(){return this.m_normalPredMode},l.SC3DMCEncodeParams.prototype.GetFloatAttributePredMode=function(e){return this.m_floatAttributePredMode[e]},l.SC3DMCEncodeParams.prototype.GetIntAttributePredMode=function(e){return this.m_intAttributePredMode[e]},l.SC3DMCEncodeParams.prototype.SetStreamType=function(e){this.m_streamTypeMode=e},l.SC3DMCEncodeParams.prototype.SetEncodeMode=function(e){this.m_encodeMode=e},l.SC3DMCEncodeParams.prototype.SetNumFloatAttributes=function(e){this.m_numFloatAttributes=e},l.SC3DMCEncodeParams.prototype.SetNumIntAttributes=function(e){this.m_numIntAttributes=e},l.SC3DMCEncodeParams.prototype.SetCoordQuantBits=function(e){this.m_coordQuantBits=e},l.SC3DMCEncodeParams.prototype.SetNormalQuantBits=function(e){this.m_normalQuantBits=e},l.SC3DMCEncodeParams.prototype.SetFloatAttributeQuantBits=function(e,t){this.m_floatAttributeQuantBits[e]=t},l.SC3DMCEncodeParams.prototype.SetCoordPredMode=function(e){this.m_coordPredMode=e},l.SC3DMCEncodeParams.prototype.SetNormalPredMode=function(e){this.m_normalPredMode=e},l.SC3DMCEncodeParams.prototype.SetFloatAttributePredMode=function(e,t){this.m_floatAttributePredMode[e]=t},l.SC3DMCEncodeParams.prototype.SetIntAttributePredMode=function(e,t){this.m_intAttributePredMode[e]=t},l.AdjacencyInfo=function(){this.m_neighborsSize=0,this.m_numNeighborsSize=0,this.m_numElements=0,this.m_neighbors={},this.m_numNeighbors={}},l.AdjacencyInfo.prototype.Allocate=function(e,t){return this.m_numElements=e,t>this.m_neighborsSize&&(this.m_neighborsSize=t,this.m_neighbors=new Int32Array(this.m_neighborsSize)),e>this.m_numNeighborsSize&&(this.m_numNeighborsSize=e,this.m_numNeighbors=new Int32Array(this.m_numNeighborsSize)),l.O3DGC_OK},l.AdjacencyInfo.prototype.AllocateNumNeighborsArray=function(e){return e>this.m_numNeighborsSize&&(this.m_numNeighborsSize=e,this.m_numNeighbors=new Int32Array(this.m_numNeighborsSize)),this.m_numElements=e,l.O3DGC_OK},l.AdjacencyInfo.prototype.AllocateNeighborsArray=function(){var e;for(e=1;this.m_numElements>e;++e)this.m_numNeighbors[e]+=this.m_numNeighbors[e-1];return this.m_numNeighbors[this.m_numElements-1]>this.m_neighborsSize&&(this.m_neighborsSize=this.m_numNeighbors[this.m_numElements-1],this.m_neighbors=new Int32Array(this.m_neighborsSize)),l.O3DGC_OK},l.AdjacencyInfo.prototype.ClearNumNeighborsArray=function(){var e;for(e=0;this.m_numElements>e;++e)this.m_numNeighbors[e]=0;return l.O3DGC_OK},l.AdjacencyInfo.prototype.ClearNeighborsArray=function(){var e;for(e=0;this.m_neighborsSize>e;++e)this.m_neighbors[e]=-1;return l.O3DGC_OK},l.AdjacencyInfo.prototype.Begin=function(e){return e>0?this.m_numNeighbors[e-1]:0},l.AdjacencyInfo.prototype.End=function(e){return this.m_numNeighbors[e]},l.AdjacencyInfo.prototype.AddNeighbor=function(e,t){var n,i,r;for(i=this.Begin(e),r=this.End(e),n=i;r>n;++n)if(-1===this.m_neighbors[n])return this.m_neighbors[n]=t,l.O3DGC_OK;return l.O3DGC_ERROR_BUFFER_FULL},l.AdjacencyInfo.prototype.GetNeighbor=function(e){return this.m_neighbors[e]},l.AdjacencyInfo.prototype.GetNumNeighbors=function(e){return this.End(e)-this.Begin(e)},l.AdjacencyInfo.prototype.GetNumNeighborsBuffer=function(){return this.m_numNeighbors},l.AdjacencyInfo.prototype.GetNeighborsBuffer=function(){return this.m_neighbors},l.Vector=function(){this.m_data={},this.m_allocated=0,this.m_size=0},l.Vector.prototype.Clear=function(){this.m_size=0},l.Vector.prototype.Get=function(e){return this.m_data[e]},l.Vector.prototype.GetAllocatedSize=function(){return this.m_allocated},l.Vector.prototype.GetSize=function(){return this.m_size},l.Vector.prototype.GetBuffer=function(){return this.m_data},l.Vector.prototype.SetSize=function(e){this.m_size=e},l.Vector.prototype.Allocate=function(e){var t,n;if(e>this.m_allocated){if(this.m_allocated=e,n=new Int32Array(this.m_allocated),this.m_size>0)for(t=0;this.m_size>t;++t)n[t]=this.m_data[t];this.m_data=n}},l.Vector.prototype.PushBack=function(e){var t,n;if(this.m_size===this.m_allocated){if(this.m_allocated*=2,this.m_allocated<u.O3DGC_DEFAULT_VECTOR_SIZE&&(this.m_allocated=u.O3DGC_DEFAULT_VECTOR_SIZE),n=new Int32Array(this.m_allocated),this.m_size>0)for(t=0;this.m_size>t;++t)n[t]=this.m_data[t];this.m_data=n}this.m_data[this.m_size++]=e},l.CompressedTriangleFans=function(){this.m_numTFANs=new l.Vector,this.m_degrees=new l.Vector,this.m_configs=new l.Vector,this.m_operations=new l.Vector,this.m_indices=new l.Vector,this.m_trianglesOrder=new l.Vector,this.m_streamType=u.O3DGC_STREAM_TYPE_UNKOWN
},l.CompressedTriangleFans.prototype.GetStreamType=function(){return this.m_streamType},l.CompressedTriangleFans.prototype.SetStreamType=function(e){this.m_streamType=e},l.CompressedTriangleFans.prototype.Clear=function(){return this.m_numTFANs.Clear(),this.m_degrees.Clear(),this.m_configs.Clear(),this.m_operations.Clear(),this.m_indices.Clear(),l.O3DGC_OK},l.CompressedTriangleFans.prototype.Allocate=function(e,t){return this.m_numTFANs.Allocate(e),this.m_degrees.Allocate(2*e),this.m_configs.Allocate(2*e),this.m_operations.Allocate(2*e),this.m_indices.Allocate(2*e),this.m_trianglesOrder.Allocate(t),this.Clear(),l.O3DGC_OK},l.CompressedTriangleFans.prototype.PushNumTFans=function(e){this.m_numTFANs.PushBack(e)},l.CompressedTriangleFans.prototype.ReadNumTFans=function(e){return this.m_numTFANs.Get(e.m_count++)},l.CompressedTriangleFans.prototype.PushDegree=function(e){this.m_degrees.PushBack(e)},l.CompressedTriangleFans.prototype.ReadDegree=function(e){return this.m_degrees.Get(e.m_count++)},l.CompressedTriangleFans.prototype.PushConfig=function(e){this.m_configs.PushBack(e)},l.CompressedTriangleFans.prototype.ReadConfig=function(e){return this.m_configs.Get(e.m_count++)},l.CompressedTriangleFans.prototype.PushOperation=function(e){this.m_operations.PushBack(e)},l.CompressedTriangleFans.prototype.ReadOperation=function(e){return this.m_operations.Get(e.m_count++)},l.CompressedTriangleFans.prototype.PushIndex=function(e){this.m_indices.PushBack(e)},l.CompressedTriangleFans.prototype.ReadIndex=function(e){return this.m_indices.Get(e.m_count++)},l.CompressedTriangleFans.prototype.PushTriangleIndex=function(e){this.m_trianglesOrder.PushBack(i(e))},l.CompressedTriangleFans.prototype.ReadTriangleIndex=function(e){return r(this.m_trianglesOrder.Get(e.m_count++))},l.CompressedTriangleFans.prototype.LoadUIntData=function(e,t,n){var i,r;for(t.ReadUInt32ASCII(n),i=t.ReadUInt32ASCII(n),e.Allocate(i),e.Clear(),r=0;i>r;++r)e.PushBack(t.ReadUIntASCII(n));return l.O3DGC_OK},l.CompressedTriangleFans.prototype.LoadIntData=function(e,t,n){var i,r;for(t.ReadUInt32ASCII(n),i=t.ReadUInt32ASCII(n),e.Allocate(i),e.Clear(),r=0;i>r;++r)e.PushBack(t.ReadIntASCII(n));return l.O3DGC_OK},l.CompressedTriangleFans.prototype.LoadBinData=function(e,t,n){var i,r,a,s;for(t.ReadUInt32ASCII(n),i=t.ReadUInt32ASCII(n),e.Allocate(i*u.O3DGC_BINARY_STREAM_BITS_PER_SYMBOL0),e.Clear(),a=0;i>a;)for(r=t.ReadUCharASCII(n),s=0;u.O3DGC_BINARY_STREAM_BITS_PER_SYMBOL0>s;++s)e.PushBack(1&r),r>>>=1,++a;return l.O3DGC_OK},l.CompressedTriangleFans.prototype.LoadUIntAC=function(e,t,n,i){var r,a,s,o,u,c,h;if(r=n.ReadUInt32Bin(i)-12,a=n.ReadUInt32Bin(i),0===a)return l.O3DGC_OK;for(s=n.ReadUInt32Bin(i),o=n.GetBuffer(i,r),i.m_count+=r,e.Allocate(a),u=new l.ArithmeticDecoder,u.SetBuffer(r,o),u.StartDecoder(),c=new l.AdaptiveDataModel,c.SetAlphabet(t+1),h=0;a>h;++h)e.PushBack(u.DecodeAdaptiveDataModel(c)+s);return l.O3DGC_OK},l.CompressedTriangleFans.prototype.LoadIntACEGC=function(e,t,n,i){var r,a,s,o,c,h,d,m,f,p;if(r=n.ReadUInt32Bin(i)-12,a=n.ReadUInt32Bin(i),0===a)return l.O3DGC_OK;for(s=n.ReadUInt32Bin(i)-u.O3DGC_MAX_LONG,o=n.GetBuffer(i,r),i.m_count+=r,e.Allocate(a),c=new l.ArithmeticDecoder,c.SetBuffer(r,o),c.StartDecoder(),h=new l.AdaptiveDataModel,h.SetAlphabet(t+2),d=new l.StaticBitModel,m=new l.AdaptiveBitModel,p=0;a>p;++p)f=c.DecodeAdaptiveDataModel(h),f===t&&(f+=c.ExpGolombDecode(0,d,m)),e.PushBack(f+s);return l.O3DGC_OK},l.CompressedTriangleFans.prototype.LoadBinAC=function(e,t,n){var i,r,a,s,o,u;if(i=t.ReadUInt32Bin(n)-8,r=t.ReadUInt32Bin(n),0===r)return l.O3DGC_OK;for(a=t.GetBuffer(n,i),n.m_count+=i,e.Allocate(r),s=new l.ArithmeticDecoder,s.SetBuffer(i,a),s.StartDecoder(),o=new l.AdaptiveBitModel,u=0;r>u;++u)e.PushBack(s.DecodeAdaptiveBitModel(o));return l.O3DGC_OK},l.CompressedTriangleFans.prototype.Load=function(e,t,n,i){return i===u.O3DGC_STREAM_TYPE_ASCII?(this.LoadUIntData(this.m_numTFANs,e,t),this.LoadUIntData(this.m_degrees,e,t),this.LoadUIntData(this.m_configs,e,t),this.LoadBinData(this.m_operations,e,t),this.LoadIntData(this.m_indices,e,t),n&&this.LoadUIntData(this.m_trianglesOrder,e,t)):(this.LoadIntACEGC(this.m_numTFANs,4,e,t),this.LoadIntACEGC(this.m_degrees,16,e,t),this.LoadUIntAC(this.m_configs,10,e,t),this.LoadBinAC(this.m_operations,e,t),this.LoadIntACEGC(this.m_indices,8,e,t),n&&this.LoadIntACEGC(this.m_trianglesOrder,16,e,t)),l.O3DGC_OK},l.TriangleFans=function(){this.m_verticesAllocatedSize=0,this.m_sizeTFANAllocatedSize=0,this.m_numTFANs=0,this.m_numVertices=0,this.m_sizeTFAN={},this.m_vertices={}},l.TriangleFans.prototype.Allocate=function(e,t){return this.m_numTFANs=0,this.m_numVertices=0,t>this.m_verticesAllocatedSize&&(this.m_verticesAllocatedSize=t,this.m_vertices=new Int32Array(this.m_verticesAllocatedSize)),e>this.m_sizeTFANAllocatedSize&&(this.m_sizeTFANAllocatedSize=e,this.m_sizeTFAN=new Int32Array(this.m_sizeTFANAllocatedSize)),l.O3DGC_OK},l.TriangleFans.prototype.Clear=function(){return this.m_numTFANs=0,this.m_numVertices=0,l.O3DGC_OK},l.TriangleFans.prototype.AddVertex=function(e){var t,n;if(++this.m_numVertices,this.m_numVertices>this.m_verticesAllocatedSize){for(this.m_verticesAllocatedSize*=2,n=new Int32Array(this.m_verticesAllocatedSize),t=0;this.m_numVertices>t;++t)n[t]=this.m_vertices[t];this.m_vertices=n}return this.m_vertices[this.m_numVertices-1]=e,++this.m_sizeTFAN[this.m_numTFANs-1],l.O3DGC_OK},l.TriangleFans.prototype.AddTFAN=function(){var e,t;if(++this.m_numTFANs,this.m_numTFANs>this.m_sizeTFANAllocatedSize){for(this.m_sizeTFANAllocatedSize*=2,t=new Int32Array(this.m_sizeTFANAllocatedSize),e=0;this.m_numTFANs>e;++e)t[e]=this.m_sizeTFAN[e];this.m_sizeTFAN=t}return this.m_sizeTFAN[this.m_numTFANs-1]=this.m_numTFANs>1?this.m_sizeTFAN[this.m_numTFANs-2]:0,l.O3DGC_OK},l.TriangleFans.prototype.Begin=function(e){return e>0?this.m_sizeTFAN[e-1]:0},l.TriangleFans.prototype.End=function(e){return this.m_sizeTFAN[e]},l.TriangleFans.prototype.GetVertex=function(e){return this.m_vertices[e]},l.TriangleFans.prototype.GetTFANSize=function(e){return this.End(e)-this.Begin(e)},l.TriangleFans.prototype.GetNumTFANs=function(){return this.m_numTFANs},l.TriangleFans.prototype.GetNumVertices=function(){return this.m_numVertices},l.TriangleListDecoder=function(){this.m_itNumTFans=new l.Iterator,this.m_itDegree=new l.Iterator,this.m_itConfig=new l.Iterator,this.m_itOperation=new l.Iterator,this.m_itIndex=new l.Iterator,this.m_maxNumVertices=0,this.m_maxNumTriangles=0,this.m_numTriangles=0,this.m_numVertices=0,this.m_tempTrianglesSize=0,this.m_vertexCount=0,this.m_triangleCount=0,this.m_numConqueredTriangles=0,this.m_numVisitedVertices=0,this.m_triangles={},this.m_tempTriangles={},this.m_visitedVertices={},this.m_visitedVerticesValence={},this.m_vertexToTriangle=new l.AdjacencyInfo,this.m_ctfans=new l.CompressedTriangleFans,this.m_tfans=new l.TriangleFans,this.m_streamType=u.O3DGC_STREAM_TYPE_ASCII,this.m_decodeTrianglesOrder=!1,this.m_decodeVerticesOrder=!1,this.m_processConfig={0:function(e,t){var n;for(e.m_tfans.AddVertex(e.m_visitedVertices[0]),n=1;t-1>n;++n)e.m_visitedVertices[e.m_numVisitedVertices++]=e.m_vertexCount,e.m_tfans.AddVertex(e.m_vertexCount++);e.m_tfans.AddVertex(e.m_visitedVertices[1])},1:function(e,t,n){var i,r,a;for(e.m_tfans.AddVertex(e.m_visitedVertices[0]),i=1;t-1>i;++i)r=e.m_ctfans.ReadOperation(e.m_itOperation),1===r?(a=e.m_ctfans.ReadIndex(e.m_itIndex),0>a?e.m_tfans.AddVertex(e.m_visitedVertices[-a-1]):e.m_tfans.AddVertex(a+n)):(e.m_visitedVertices[e.m_numVisitedVertices++]=e.m_vertexCount,e.m_tfans.AddVertex(e.m_vertexCount++));e.m_tfans.AddVertex(e.m_visitedVertices[1])},2:function(e,t){var n;for(n=0;t-1>n;++n)e.m_visitedVertices[e.m_numVisitedVertices++]=e.m_vertexCount,e.m_tfans.AddVertex(e.m_vertexCount++);e.m_tfans.AddVertex(e.m_visitedVertices[0])},3:function(e,t){var n;for(n=0;t-1>n;++n)e.m_visitedVertices[e.m_numVisitedVertices++]=e.m_vertexCount,e.m_tfans.AddVertex(e.m_vertexCount++);e.m_tfans.AddVertex(e.m_visitedVertices[1])},4:function(e,t){var n;for(e.m_tfans.AddVertex(e.m_visitedVertices[0]),n=1;t>n;++n)e.m_visitedVertices[e.m_numVisitedVertices++]=e.m_vertexCount,e.m_tfans.AddVertex(e.m_vertexCount++)},5:function(e,t){var n;for(e.m_tfans.AddVertex(e.m_visitedVertices[1]),n=1;t>n;++n)e.m_visitedVertices[e.m_numVisitedVertices++]=e.m_vertexCount,e.m_tfans.AddVertex(e.m_vertexCount++)},6:function(e,t){var n;for(n=0;t>n;++n)e.m_visitedVertices[e.m_numVisitedVertices++]=e.m_vertexCount,e.m_tfans.AddVertex(e.m_vertexCount++)},7:function(e,t){var n;for(e.m_tfans.AddVertex(e.m_visitedVertices[1]),n=1;t-1>n;++n)e.m_visitedVertices[e.m_numVisitedVertices++]=e.m_vertexCount,e.m_tfans.AddVertex(e.m_vertexCount++);e.m_tfans.AddVertex(e.m_visitedVertices[0])},8:function(e,t,n){var i,r,a;for(e.m_tfans.AddVertex(e.m_visitedVertices[1]),i=1;t-1>i;++i)r=e.m_ctfans.ReadOperation(e.m_itOperation),1===r?(a=e.m_ctfans.ReadIndex(e.m_itIndex),0>a?e.m_tfans.AddVertex(e.m_visitedVertices[-a-1]):e.m_tfans.AddVertex(a+n)):(e.m_visitedVertices[e.m_numVisitedVertices++]=e.m_vertexCount,e.m_tfans.AddVertex(e.m_vertexCount++));e.m_tfans.AddVertex(e.m_visitedVertices[0])},9:function(e,t,n){var i,r,a;for(i=0;t>i;++i)r=e.m_ctfans.ReadOperation(e.m_itOperation),1===r?(a=e.m_ctfans.ReadIndex(e.m_itIndex),0>a?e.m_tfans.AddVertex(e.m_visitedVertices[-a-1]):e.m_tfans.AddVertex(a+n)):(e.m_visitedVertices[e.m_numVisitedVertices++]=e.m_vertexCount,e.m_tfans.AddVertex(e.m_vertexCount++))}}},l.TriangleListDecoder.prototype.GetStreamType=function(){return this.m_streamType},l.TriangleListDecoder.prototype.GetReorderTriangles=function(){return this.m_decodeTrianglesOrder},l.TriangleListDecoder.prototype.GetReorderVertices=function(){return this.m_decodeVerticesOrder},l.TriangleListDecoder.prototype.SetStreamType=function(e){this.m_streamType=e},l.TriangleListDecoder.prototype.GetVertexToTriangle=function(){return this.m_vertexToTriangle},l.TriangleListDecoder.prototype.Reorder=function(){var e,t,n,i,a,s,o,u;if(this.m_decodeTrianglesOrder)for(e=this.m_triangles,t=this.m_numTriangles,n=this.m_ctfans.m_trianglesOrder.m_data,s=this.m_tempTriangles,s.set(e),i=0,a=0,u=0;t>u;++u)o=r(n[i++])+a,e[3*o]=s[3*u],e[3*o+1]=s[3*u+1],e[3*o+2]=s[3*u+2],a=o+1;return l.O3DGC_OK},l.TriangleListDecoder.prototype.CompueLocalConnectivityInfo=function(e){var t,n,i,r,a,s,o,u,c,h,d,m,f,p,v,_,g,b,y;for(t=this.m_visitedVertices,n=this.m_visitedVerticesValence,i=this.m_triangles,r=this.m_vertexToTriangle,a=r.Begin(e),s=r.End(e),o=0,c=0,g=0,d=a;g>=0&&s>d;++d)if(g=r.GetNeighbor(d),g>=0)for(++o,b=3*g,f=0;3>f;++f)if(y=i[b+f],y>e){for(u=!1,m=0;c>m;++m){if(y===t[m]){n[m]++,u=!0;break}if(t[m]>y){for(++c,p=c-1;p>m;--p)t[p]=t[p-1],n[p]=n[p-1];t[m]=y,n[m]=1,u=!0;break}}u||(t[c]=y,n[c]=1,c++)}if(c>2)for(v=1;c>v;++v)if(1===n[v])for(_=v;_>0&&n[_]<n[_-1];)h=n[_],n[_]=n[_-1],n[_-1]=h,h=t[_],t[_]=t[_-1],t[_-1]=h,--_;return this.m_numConqueredTriangles=o,this.m_numVisitedVertices=c,l.O3DGC_OK},l.TriangleListDecoder.prototype.DecompressTFAN=function(e){var t,n,i,r,a,s,o,u,c,h,d,m,f,p,v,_,g,b,y;if(t=this.m_vertexToTriangle,n=this.m_triangles,i=this.m_itDegree,r=this.m_itConfig,a=this.m_tfans,o=this.m_processConfig,u=this.m_ctfans,c=this.m_triangleCount,h=this.m_numConqueredTriangles,s=u.ReadNumTFans(this.m_itNumTFans),s>0)for(b=0;s>b;++b)for(a.AddTFAN(),d=u.ReadDegree(i)+2-h,m=u.ReadConfig(r),f=a.GetNumVertices(),a.AddVertex(e),o[m](this,d,e),p=a.GetNumVertices(),v=a.GetVertex(f+1),y=f+2;p>y;++y)_=a.GetVertex(y),g=3*c,n[g++]=e,n[g++]=v,n[g]=_,t.AddNeighbor(e,c),t.AddNeighbor(v,c),t.AddNeighbor(_,c),v=_,c++;return this.m_triangleCount=c,l.O3DGC_OK},l.TriangleListDecoder.prototype.Decompress=function(){var e;for(e=0;this.m_numVertices>e;++e)e===this.m_vertexCount&&this.m_vertexCount++,this.CompueLocalConnectivityInfo(e),this.DecompressTFAN(e);return l.O3DGC_OK},l.TriangleListDecoder.prototype.Init=function(e,t,n,i){var r,a;for(this.m_numTriangles=t,this.m_numVertices=n,this.m_triangles=e,this.m_vertexCount=0,this.m_triangleCount=0,this.m_itNumTFans.m_count=0,this.m_itDegree.m_count=0,this.m_itConfig.m_count=0,this.m_itOperation.m_count=0,this.m_itIndex.m_count=0,this.m_numVertices>this.m_maxNumVertices&&(this.m_maxNumVertices=this.m_numVertices,this.m_visitedVerticesValence=new Int32Array(this.m_numVertices),this.m_visitedVertices=new Int32Array(this.m_numVertices)),this.m_decodeTrianglesOrder&&this.m_tempTrianglesSize<this.m_numTriangles&&(this.m_tempTrianglesSize=this.m_numTriangles,this.m_tempTriangles=new Int32Array(3*this.m_tempTrianglesSize)),this.m_ctfans.SetStreamType(this.m_streamType),this.m_ctfans.Allocate(this.m_numVertices,this.m_numTriangles),this.m_tfans.Allocate(2*this.m_numVertices,8*this.m_numVertices),this.m_vertexToTriangle.AllocateNumNeighborsArray(n),a=this.m_vertexToTriangle.GetNumNeighborsBuffer(),r=0;n>r;++r)a[r]=i;return this.m_vertexToTriangle.AllocateNeighborsArray(),this.m_vertexToTriangle.ClearNeighborsArray(),l.O3DGC_OK},l.TriangleListDecoder.prototype.Decode=function(e,t,n,i,r){var a,s;return a=i.ReadUChar(r,this.m_streamType),this.m_decodeTrianglesOrder=0!==(2&a),this.m_decodeVerticesOrder=0!==(1&a),this.m_decodeVerticesOrder?l.O3DGC_ERROR_NON_SUPPORTED_FEATURE:(s=i.ReadUInt32(r,this.m_streamType),this.Init(e,t,n,s),this.m_ctfans.Load(i,r,this.m_decodeTrianglesOrder,this.m_streamType),this.Decompress(),l.O3DGC_OK)},l.SC3DMCDecoder=function(){var e;for(this.m_iterator=new l.Iterator,this.m_streamSize=0,this.m_params=new l.SC3DMCEncodeParams,this.m_triangleListDecoder=new l.TriangleListDecoder,this.m_quantFloatArray={},this.m_orientation={},this.m_normals={},this.m_quantFloatArraySize=0,this.m_normalsSize=0,this.m_orientationSize=0,this.m_stats=new l.SC3DMCStats,this.m_streamType=u.O3DGC_STREAM_TYPE_UNKOWN,this.m_neighbors=[],this.m_idelta=new Float32Array(u.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES),this.m_minNormal=new Float32Array(2),this.m_maxNormal=new Float32Array(2),this.m_minNormal[0]=this.m_minNormal[1]=-2,this.m_maxNormal[0]=this.m_maxNormal[1]=2,e=0;u.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES>e;++e)this.m_neighbors[e]=new l.SC3DMCPredictor},l.SC3DMCDecoder.prototype.GetStats=function(){return this.m_stats},l.SC3DMCDecoder.prototype.DecodeHeader=function(e,t){var n,i,r,a,s,o;if(n=this.m_iterator.m_count,i=t.ReadUInt32(this.m_iterator,u.O3DGC_STREAM_TYPE_BINARY),i!==u.O3DGC_SC3DMC_START_CODE){if(this.m_iterator.m_count=n,i=t.ReadUInt32(this.m_iterator,u.O3DGC_STREAM_TYPE_ASCII),i!==u.O3DGC_SC3DMC_START_CODE)return l.O3DGC_ERROR_CORRUPTED_STREAM;this.m_streamType=u.O3DGC_STREAM_TYPE_ASCII}else this.m_streamType=u.O3DGC_STREAM_TYPE_BINARY;if(this.m_streamSize=t.ReadUInt32(this.m_iterator,this.m_streamType),this.m_params.SetEncodeMode(t.ReadUChar(this.m_iterator,this.m_streamType)),e.SetCreaseAngle(t.ReadFloat32(this.m_iterator,this.m_streamType)),r=t.ReadUChar(this.m_iterator,this.m_streamType),e.SetCCW(1===(1&r)),e.SetSolid(1===(2&r)),e.SetConvex(1===(4&r)),e.SetIsTriangularMesh(1===(8&r)),e.SetNCoord(t.ReadUInt32(this.m_iterator,this.m_streamType)),e.SetNNormal(t.ReadUInt32(this.m_iterator,this.m_streamType)),e.SetNumFloatAttributes(t.ReadUInt32(this.m_iterator,this.m_streamType)),e.SetNumIntAttributes(t.ReadUInt32(this.m_iterator,this.m_streamType)),e.GetNCoord()>0){for(e.SetNCoordIndex(t.ReadUInt32(this.m_iterator,this.m_streamType)),a=0;3>a;++a)e.SetCoordMin(a,t.ReadFloat32(this.m_iterator,this.m_streamType)),e.SetCoordMax(a,t.ReadFloat32(this.m_iterator,this.m_streamType));this.m_params.SetCoordQuantBits(t.ReadUChar(this.m_iterator,this.m_streamType))}if(e.GetNNormal()>0){for(e.SetNNormalIndex(t.ReadUInt32(this.m_iterator,this.m_streamType)),a=0;3>a;++a)e.SetNormalMin(a,t.ReadFloat32(this.m_iterator,this.m_streamType)),e.SetNormalMax(a,t.ReadFloat32(this.m_iterator,this.m_streamType));e.SetNormalPerVertex(1===t.ReadUChar(this.m_iterator,this.m_streamType)),this.m_params.SetNormalQuantBits(t.ReadUChar(this.m_iterator,this.m_streamType))}for(s=0;e.GetNumFloatAttributes()>s;++s)if(e.SetNFloatAttribute(s,t.ReadUInt32(this.m_iterator,this.m_streamType)),e.GetNFloatAttribute(s)>0){for(e.SetNFloatAttributeIndex(s,t.ReadUInt32(this.m_iterator,this.m_streamType)),o=t.ReadUChar(this.m_iterator,this.m_streamType),e.SetFloatAttributeDim(s,o),a=0;o>a;++a)e.SetFloatAttributeMin(s,a,t.ReadFloat32(this.m_iterator,this.m_streamType)),e.SetFloatAttributeMax(s,a,t.ReadFloat32(this.m_iterator,this.m_streamType));e.SetFloatAttributePerVertex(s,1===t.ReadUChar(this.m_iterator,this.m_streamType)),e.SetFloatAttributeType(s,t.ReadUChar(this.m_iterator,this.m_streamType)),this.m_params.SetFloatAttributeQuantBits(s,t.ReadUChar(this.m_iterator,this.m_streamType))}for(s=0;e.GetNumIntAttributes()>s;++s)e.SetNIntAttribute(s,t.ReadUInt32(this.m_iterator,this.m_streamType)),e.GetNIntAttribute(s)>0&&(e.SetNIntAttributeIndex(s,t.ReadUInt32(this.m_iterator,this.m_streamType)),e.SetIntAttributeDim(s,t.ReadUChar(this.m_iterator,this.m_streamType)),e.SetIntAttributePerVertex(s,1===t.ReadUChar(this.m_iterator,this.m_streamType)),e.SetIntAttributeType(s,t.ReadUChar(this.m_iterator,this.m_streamType)));return l.O3DGC_OK},l.SC3DMCDecoder.prototype.DecodeIntArrayBinary=function(e,t,n,i,r,s,o){var c,h,d,m,f,p,v,_,g,b,y,w,D,S,C,E,T,O,M,I,P,A,x,L,N,R,z,F,j,k,V,B;if(g=this.m_iterator,b=this.m_streamType,w=new l.ArithmeticDecoder,D=new l.StaticBitModel,S=new l.AdaptiveBitModel,C=new l.AdaptiveDataModel,C.SetAlphabet(u.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS+1),E=this.m_triangleListDecoder.GetVertexToTriangle(),T=E.m_neighbors,O=r.GetCoordIndex(),M=t*n,I=g.m_count,P=o.ReadUInt32(g,b),A=o.ReadUChar(g,b),x=7&A>>>4,s.m_value=7&A,P-=g.m_count-I,L=new l.Iterator,L.m_count=g.m_count+P,N=0,R=0,z=new l.SC3DMCTriplet(-1,-1,-1),x!==u.O3DGC_SC3DMC_BINARIZATION_AC_EGC)return l.O3DGC_ERROR_CORRUPTED_STREAM;for(_=o.GetBuffer(g,P),g.m_count+=P,w.SetBuffer(P,_),w.StartDecoder(),N=w.ExpGolombDecode(0,D,S),R=w.ExpGolombDecode(0,D,S),F=new l.AdaptiveDataModel,F.SetAlphabet(R+2),j=this.m_neighbors,k=this.m_normals,V=new l.NumberRef,c=s.m_value!==u.O3DGC_SC3DMC_NO_PREDICTION,B=0;t>B;++B){if(V.m_value=0,E.GetNumNeighbors(B)>0&&c)for(p=E.Begin(B),v=E.End(B),m=p;v>m&&(f=T[m],!(0>f));++m)a(O,f,B,V,j,n,e,i);if(V.m_value>1)for(h=w.DecodeAdaptiveDataModel(C),d=0;n>d;++d)y=w.DecodeIntACEGC(F,D,S,N,R),e[B*i+d]=y+j[h].m_pred[d];else if(B>0&&s.m_value!==u.O3DGC_SC3DMC_NO_PREDICTION)for(d=0;n>d;++d)y=w.DecodeIntACEGC(F,D,S,N,R),e[B*i+d]=y+e[(B-1)*i+d];else for(d=0;n>d;++d)y=w.DecodeUIntACEGC(F,D,S,N,R),e[B*i+d]=y}return g.m_count=L.m_count,l.O3DGC_OK},l.SC3DMCDecoder.prototype.DecodeIntArrayASCII=function(e,t,n,i,r,s,o){var c,h,d,m,f,p,v,_,g,b,y,w,D,S,C,E,T,O,M,I,P,A,x,L;if(h=this.m_iterator,d=this.m_streamType,f=this.m_triangleListDecoder.GetVertexToTriangle(),p=f.m_neighbors,v=r.GetCoordIndex(),_=t*n,g=h.m_count,b=o.ReadUInt32(h,d),y=o.ReadUChar(h,d),w=7&y>>>4,s.m_value=7&y,b-=h.m_count-g,D=new l.Iterator,D.m_count=h.m_count+b,S=new l.SC3DMCTriplet(-1,-1,-1),w!==u.O3DGC_SC3DMC_BINARIZATION_ASCII)return l.O3DGC_ERROR_CORRUPTED_STREAM;for(o.ReadUInt32(D,d),C=this.m_neighbors,E=this.m_normals,T=new l.NumberRef,c=s.m_value!==u.O3DGC_SC3DMC_NO_PREDICTION,O=0;t>O;++O){if(T.m_value=0,f.GetNumNeighbors(O)>0&&c)for(M=f.Begin(O),I=f.End(O),P=M;I>P&&(A=p[P],!(0>A));++P)a(v,A,O,T,C,n,e,i);if(T.m_value>1)for(L=o.ReadUCharASCII(D),x=0;n>x;++x)m=o.ReadIntASCII(h),e[O*i+x]=m+C[L].m_pred[x];else if(O>0&&s.m_value!==u.O3DGC_SC3DMC_NO_PREDICTION)for(x=0;n>x;++x)m=o.ReadIntASCII(h),e[O*i+x]=m+e[(O-1)*i+x];else for(x=0;n>x;++x)m=o.ReadUIntASCII(h),e[O*i+x]=m}return h.m_count=D.m_count,l.O3DGC_OK},l.SC3DMCDecoder.prototype.DecodeIntArray=function(e,t,n,i,r,a,s){return this.m_streamType===u.O3DGC_STREAM_TYPE_ASCII?this.DecodeIntArrayASCII(e,t,n,i,r,a,s):this.DecodeIntArrayBinary(e,t,n,i,r,a,s)},l.SC3DMCDecoder.prototype.ProcessNormals=function(e){var t,i,r,a,s,u,c,h,d,m,f,p,v,_,g;for(r=e.GetNNormal(),a=3*e.GetNNormal(),a>this.m_normalsSize&&(this.m_normalsSize=a,this.m_normals=new Float32Array(this.m_normalsSize)),s=this.m_normals,u=this.m_quantFloatArray,c=this.m_orientation,h=e.GetCoordIndex(),o(h,e.GetNCoordIndex(),u,r,s),d=new l.Vec3,m=new l.Vec3,f=0;r>f;++f)t=3*f,d.m_x=s[t],d.m_y=s[t+1],d.m_z=s[t+2],g=Math.sqrt(d.m_x*d.m_x+d.m_y*d.m_y+d.m_z*d.m_z),0===g&&(g=1),n(d,m),p=m.m_x/g,v=m.m_y/g,_=m.m_z+c[f],c[f]=_,_>>>1!==m.m_z>>>1&&(p=0,v=0),i=2*f,s[i]=p,s[i+1]=v;return l.O3DGC_OK},l.SC3DMCDecoder.prototype.IQuantize=function(e,t,n,i,r,a,s,o){var c,h,d,m,f,p;if(o.m_value===u.O3DGC_SC3DMC_SURF_NORMALS_PREDICTION)for(p=u.CubeToSphere,m=this.m_orientation,f=this.m_normals,h=new l.Vec3(0,0,0),d=new l.Vec3(0,0,0),this.IQuantizeFloatArray(e,t,n,i,this.m_minNormal,this.m_maxNormal,s+1),c=0;t>c;++c)h.m_x=e[i*c]+f[2*c],h.m_y=e[i*c+1]+f[2*c+1],h.m_z=m[c],p[h.m_z](h,d),e[i*c]=d.m_x,e[i*c+1]=d.m_y,e[i*c+2]=d.m_z;else this.IQuantizeFloatArray(e,t,n,i,r,a,s)},l.SC3DMCDecoder.prototype.DecodeFloatArrayBinary=function(e,t,n,i,o,c,h,d,m,f){var p,v,_,g,b,y,w,D,S,C,E,T,O,M,I,P,A,x,L,N,R,z,F,j,k,V,B,q,U,G,W,Y,K,H,X,$;if(A=this.m_iterator,x=this.m_orientation,L=this.m_streamType,R=new l.ArithmeticDecoder,z=new l.StaticBitModel,F=new l.AdaptiveBitModel,j=new l.AdaptiveDataModel,p=u.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS,j.SetAlphabet(p+1),k=this.m_triangleListDecoder.GetVertexToTriangle(),V=k.m_neighbors,B=d.GetCoordIndex(),q=t*n,U=A.m_count,G=f.ReadUInt32(A,L),W=f.ReadUChar(A,L),Y=7&W>>>4,m.m_value=7&W,G-=A.m_count-U,K=new l.Iterator,K.m_count=A.m_count+G,H=0,X=0,Y!==u.O3DGC_SC3DMC_BINARIZATION_AC_EGC)return l.O3DGC_ERROR_CORRUPTED_STREAM;if(y=f.GetBuffer(A,G),A.m_count+=G,R.SetBuffer(G,y),R.StartDecoder(),H=R.ExpGolombDecode(0,z,F),X=R.ExpGolombDecode(0,z,F),$=new l.AdaptiveDataModel,$.SetAlphabet(X+2),m.m_value===u.O3DGC_SC3DMC_SURF_NORMALS_PREDICTION){for(q>this.m_orientationSize&&(this.m_orientationSize=q,this.m_orientation=new Int8Array(this.m_orientationSize),x=this.m_orientation),b=new l.AdaptiveDataModel,b.SetAlphabet(12),T=0;t>T;++T)x[T]=r(R.DecodeAdaptiveDataModel(b));this.ProcessNormals(d),n=2}for(q>this.m_quantFloatArraySize&&(this.m_quantFloatArraySize=q,this.m_quantFloatArray=new Int32Array(this.m_quantFloatArraySize)),w=this.m_quantFloatArray,D=this.m_neighbors,S=this.m_normals,C=new l.NumberRef,v=m.m_value!==u.O3DGC_SC3DMC_NO_PREDICTION,_=m.m_value===u.O3DGC_SC3DMC_PARALLELOGRAM_PREDICTION,O=0;t>O;++O){if(C.m_value=0,k.GetNumNeighbors(O)>0&&v){if(I=k.Begin(O),P=k.End(O),_)for(M=I;P>M&&(E=V[M],!(0>E));++M)s(B,E,O,C,D,n,w,i,k,V);if(p>C.m_value)for(M=I;P>M&&(E=V[M],!(0>E));++M)a(B,E,O,C,D,n,w,i)}if(C.m_value>1)for(g=R.DecodeAdaptiveDataModel(j),T=0;n>T;++T)N=R.DecodeIntACEGC($,z,F,H,X),w[O*i+T]=N+D[g].m_pred[T];else if(O>0&&v)for(T=0;n>T;++T)N=R.DecodeIntACEGC($,z,F,H,X),w[O*i+T]=N+w[(O-1)*i+T];else for(T=0;n>T;++T)N=R.DecodeUIntACEGC($,z,F,H,X),w[O*i+T]=N}return A.m_count=K.m_count,this.IQuantize(e,t,n,i,o,c,h,m),l.O3DGC_OK},l.SC3DMCDecoder.prototype.DecodeFloatArrayASCII=function(e,t,n,i,r,o,c,h,d,m){var f,p,v,_,g,b,y,w,D,S,C,E,T,O,M,I,P,A,x,L,N,R,z,F,j,k,V;if(f=u.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS,_=this.m_iterator,g=this.m_orientation,b=this.m_streamType,w=this.m_triangleListDecoder.GetVertexToTriangle(),D=w.m_neighbors,S=h.GetCoordIndex(),C=t*n,E=_.m_count,T=m.ReadUInt32(_,b),O=m.ReadUChar(_,b),M=7&O>>>4,d.m_value=7&O,T-=_.m_count-E,I=new l.Iterator,I.m_count=_.m_count+T,M!==u.O3DGC_SC3DMC_BINARIZATION_ASCII)return l.O3DGC_ERROR_CORRUPTED_STREAM;if(m.ReadUInt32(I,b),d.m_value===u.O3DGC_SC3DMC_SURF_NORMALS_PREDICTION){for(t>this.m_orientationSize&&(this.m_orientationSize=t,this.m_orientation=new Int8Array(this.m_orientationSize),g=this.m_orientation),k=0;t>k;++k)g[k]=m.ReadIntASCII(_);this.ProcessNormals(h),n=2}for(C>this.m_quantFloatArraySize&&(this.m_quantFloatArraySize=C,this.m_quantFloatArray=new Int32Array(this.m_quantFloatArraySize)),P=this.m_quantFloatArray,A=this.m_neighbors,x=this.m_normals,L=new l.NumberRef,p=d.m_value!==u.O3DGC_SC3DMC_NO_PREDICTION,v=d.m_value===u.O3DGC_SC3DMC_PARALLELOGRAM_PREDICTION,N=0;t>N;++N){if(L.m_value=0,w.GetNumNeighbors(N)>0&&p){if(z=w.Begin(N),F=w.End(N),v)for(R=z;F>R&&(j=D[R],!(0>j));++R)s(S,j,N,L,A,n,P,i,w,D);if(f>L.m_value)for(R=z;F>R&&(j=D[R],!(0>j));++R)a(S,j,N,L,A,n,P,i)}if(L.m_value>1)for(V=m.ReadUCharASCII(I),k=0;n>k;++k)y=m.ReadIntASCII(_),P[N*i+k]=y+A[V].m_pred[k];else if(N>0&&d.m_value!==u.O3DGC_SC3DMC_NO_PREDICTION)for(k=0;n>k;++k)y=m.ReadIntASCII(_),P[N*i+k]=y+P[(N-1)*i+k];else for(k=0;n>k;++k)y=m.ReadUIntASCII(_),P[N*i+k]=y}return _.m_count=I.m_count,this.IQuantize(e,t,n,i,r,o,c,d),l.O3DGC_OK},l.SC3DMCDecoder.prototype.DecodeFloatArray=function(e,t,n,i,r,a,s,o,l,c){return this.m_streamType===u.O3DGC_STREAM_TYPE_ASCII?this.DecodeFloatArrayASCII(e,t,n,i,r,a,s,o,l,c):this.DecodeFloatArrayBinary(e,t,n,i,r,a,s,o,l,c)},l.SC3DMCDecoder.prototype.IQuantizeFloatArray=function(e,t,n,i,r,a,s){var o,u,c,h,d;for(o=this.m_idelta,u=this.m_quantFloatArray,c=0;n>c;++c)h=a[c]-r[c],o[c]=h>0?h/((1<<s>>>0)-1):1;for(d=0;t>d;++d)for(c=0;n>c;++c)e[d*i+c]=u[d*i+c]*o[c]+r[c];return l.O3DGC_OK},l.SC3DMCDecoder.prototype.DecodePlayload=function(e,t){var n,i,r,a,s,o,u;if(n=this.m_params,i=this.m_iterator,r=this.m_stats,a=new l.NumberRef,s=new l.Timer,o=l.O3DGC_OK,this.m_triangleListDecoder.SetStreamType(this.m_streamType),r.m_streamSizeCoordIndex=i.m_count,s.Tic(),this.m_triangleListDecoder.Decode(e.GetCoordIndex(),e.GetNCoordIndex(),e.GetNCoord(),t,i),s.Toc(),r.m_timeCoordIndex=s.GetElapsedTime(),r.m_streamSizeCoordIndex=i.m_count-r.m_streamSizeCoordIndex,r.m_streamSizeCoord=i.m_count,s.Tic(),e.GetNCoord()>0&&(o=this.DecodeFloatArray(e.GetCoord(),e.GetNCoord(),3,3,e.GetCoordMinArray(),e.GetCoordMaxArray(),n.GetCoordQuantBits(),e,a,t),n.SetCoordPredMode(a.m_value)),o!==l.O3DGC_OK)return o;if(s.Toc(),r.m_timeCoord=s.GetElapsedTime(),r.m_streamSizeCoord=i.m_count-r.m_streamSizeCoord,r.m_streamSizeNormal=i.m_count,s.Tic(),e.GetNNormal()>0&&(o=this.DecodeFloatArray(e.GetNormal(),e.GetNNormal(),3,3,e.GetNormalMinArray(),e.GetNormalMaxArray(),n.GetNormalQuantBits(),e,a,t),n.SetNormalPredMode(a.m_value)),o!==l.O3DGC_OK)return o;for(s.Toc(),r.m_timeNormal=s.GetElapsedTime(),r.m_streamSizeNormal=i.m_count-r.m_streamSizeNormal,u=0;e.GetNumFloatAttributes()>u;++u)r.m_streamSizeFloatAttribute[u]=i.m_count,s.Tic(),o=this.DecodeFloatArray(e.GetFloatAttribute(u),e.GetNFloatAttribute(u),e.GetFloatAttributeDim(u),e.GetFloatAttributeDim(u),e.GetFloatAttributeMinArray(u),e.GetFloatAttributeMaxArray(u),n.GetFloatAttributeQuantBits(u),e,a,t),n.SetFloatAttributePredMode(u,a.m_value),s.Toc(),r.m_timeFloatAttribute[u]=s.GetElapsedTime(),r.m_streamSizeFloatAttribute[u]=i.m_count-r.m_streamSizeFloatAttribute[u];if(o!==l.O3DGC_OK)return o;for(u=0;e.GetNumIntAttributes()>u;++u)r.m_streamSizeIntAttribute[u]=i.m_count,s.Tic(),o=this.DecodeIntArray(e.GetIntAttribute(u),e.GetNIntAttribute(u),e.GetIntAttributeDim(u),e.GetIntAttributeDim(u),e,a,t),n.SetIntAttributePredMode(u,a.m_value),s.Toc(),r.m_timeIntAttribute[u]=s.GetElapsedTime(),r.m_streamSizeIntAttribute[u]=i.m_count-r.m_streamSizeIntAttribute[u];return o!==l.O3DGC_OK?o:(s.Tic(),this.m_triangleListDecoder.Reorder(),s.Toc(),r.m_timeReorder=s.GetElapsedTime(),o)},l.DVEncodeParams=function(){this.m_encodeMode=u.O3DGC_DYNAMIC_VECTOR_ENCODE_MODE_LIFT,this.m_streamTypeMode=u.O3DGC_STREAM_TYPE_ASCII,this.m_quantBits=10},l.DVEncodeParams.prototype.GetStreamType=function(){return this.m_streamTypeMode},l.DVEncodeParams.prototype.GetEncodeMode=function(){return this.m_encodeMode},l.DVEncodeParams.prototype.GetQuantBits=function(){return this.m_quantBits},l.DVEncodeParams.prototype.SetStreamType=function(e){this.m_streamTypeMode=e},l.DVEncodeParams.prototype.SetEncodeMode=function(e){this.m_encodeMode=e},l.DVEncodeParams.prototype.SetQuantBits=function(e){this.m_quantBits=e},l.DynamicVector=function(){this.m_num=0,this.m_dim=0,this.m_stride=0,this.m_max={},this.m_min={},this.m_vectors={}},l.DynamicVector.prototype.GetNVector=function(){return this.m_num},l.DynamicVector.prototype.GetDimVector=function(){return this.m_dim},l.DynamicVector.prototype.GetStride=function(){return this.m_stride},l.DynamicVector.prototype.GetMinArray=function(){return this.m_min},l.DynamicVector.prototype.GetMaxArray=function(){return this.m_max},l.DynamicVector.prototype.GetVectors=function(){return this.m_vectors},l.DynamicVector.prototype.GetMin=function(e){return this.m_min[e]},l.DynamicVector.prototype.GetMax=function(e){return this.m_max[e]},l.DynamicVector.prototype.SetNVector=function(e){this.m_num=e},l.DynamicVector.prototype.SetDimVector=function(e){this.m_dim=e},l.DynamicVector.prototype.SetStride=function(e){this.m_stride=e},l.DynamicVector.prototype.SetMinArray=function(e){this.m_min=e},l.DynamicVector.prototype.SetMaxArray=function(e){this.m_max=e},l.DynamicVector.prototype.SetMin=function(e,t){this.m_min[e]=t},l.DynamicVector.prototype.SetMax=function(e,t){this.m_max[e]=t},l.DynamicVector.prototype.SetVectors=function(e){this.m_vectors=e},l.DynamicVectorDecoder=function(){this.m_streamSize=0,this.m_maxNumVectors=0,this.m_numVectors=0,this.m_dimVectors=0,this.m_quantVectors={},this.m_iterator=new l.Iterator,this.m_streamType=u.O3DGC_STREAM_TYPE_UNKOWN,this.m_params=new l.DVEncodeParams},l.DynamicVectorDecoder.prototype.GetStreamType=function(){return this.m_streamType},l.DynamicVectorDecoder.prototype.GetIterator=function(){return this.m_iterator},l.DynamicVectorDecoder.prototype.SetStreamType=function(e){this.m_streamType=e},l.DynamicVectorDecoder.prototype.SetIterator=function(e){this.m_iterator=e},l.DynamicVectorDecoder.prototype.IUpdate=function(e,t,n){var i,r;for(r=n-1,i=2,e[t]-=e[t+1]>>1;r>i;)e[t+i]-=e[t+i-1]+e[t+i+1]+2>>2,i+=2;return i===r&&(e[t+i]-=e[t+i-1]>>1),l.O3DGC_OK},l.DynamicVectorDecoder.prototype.IPredict=function(e,t,n){var i,r;for(r=n-1,i=1;r>i;)e[t+i]+=e[t+i-1]+e[t+i+1]+1>>1,i+=2;return i===r&&(e[t+i]+=e[t+i-1]),l.O3DGC_OK},l.DynamicVectorDecoder.prototype.Merge=function(e,t,n){var i,r,a,s,o;for(r=(n>>1)+(1&n),a=r-1,s=r;a>0;){for(i=a;s>i;i+=2)o=e[t+i],e[t+i]=e[t+i+1],e[t+i+1]=o;--a,++s}return l.O3DGC_OK},l.DynamicVectorDecoder.prototype.ITransform=function(e,t,n){var i,r,a,s;for(i=n,r=0,a=0,r+=(1&i)<<a++>>>0;i>1;)i=(i>>1)+((1&i)>>>0),r+=(1&i)<<a++>>>0;for(s=a-2;s>=0;--s)i=(i<<1>>>0)-(1&r>>>s)>>>0,this.Merge(e,t,i),this.IUpdate(e,t,i),this.IPredict(e,t,i);return l.O3DGC_OK},l.DynamicVectorDecoder.prototype.IQuantize=function(e,t,n,i,r,a,s){var o,u,c,h,d,m;for(o=this.m_quantVectors,h=t*n,d=0;n>d;++d)for(u=a[d]-r[d],c=u>0?u/((1<<s>>>0)-1):1,m=0;t>m;++m)e[m*i+d]=o[m+d*t]*c+r[d];return l.O3DGC_OK},l.DynamicVectorDecoder.prototype.DecodeHeader=function(e,t){var n,i,r,a;if(n=this.m_iterator,i=n.m_count,r=t.ReadUInt32(n,u.O3DGC_STREAM_TYPE_BINARY),r!==u.O3DGC_DV_START_CODE){if(n.m_count=i,r=t.ReadUInt32(n,u.O3DGC_STREAM_TYPE_ASCII),r!==u.O3DGC_DV_START_CODE)return l.O3DGC_ERROR_CORRUPTED_STREAM;this.m_streamType=u.O3DGC_STREAM_TYPE_ASCII}else this.m_streamType=u.O3DGC_STREAM_TYPE_BINARY;return a=this.m_streamType,this.m_streamSize=t.ReadUInt32(n,a),this.m_params.SetEncodeMode(t.ReadUChar(n,a)),e.SetNVector(t.ReadUInt32(n,a)),e.GetNVector()>0&&(e.SetDimVector(t.ReadUInt32(n,a)),this.m_params.SetQuantBits(t.ReadUChar(n,a))),l.O3DGC_OK},l.DynamicVectorDecoder.prototype.DecodePlayload=function(e,t){var n,i,r,a,s,o,c,h,d,m,f,p,v,_,g,b,y,w,D;for(i=this.m_iterator,r=this.m_streamType,a=l.O3DGC_OK,s=i.m_count,o=t.ReadUInt32(i,r),c=e.GetDimVector(),h=e.GetNVector(),n=c*h,d=0;e.GetDimVector()>d;++d)e.SetMin(d,t.ReadFloat32(i,r)),e.SetMax(d,t.ReadFloat32(i,r));if(m=new l.ArithmeticDecoder,f=new l.StaticBitModel,p=new l.AdaptiveBitModel,o-=i.m_count-s,v=0,_=0,r===u.O3DGC_STREAM_TYPE_BINARY&&(g=t.GetBuffer(i,o),i.m_count+=o,m.SetBuffer(o,g),m.StartDecoder(),v=m.ExpGolombDecode(0,f,p),_=m.ExpGolombDecode(0,f,p)),b=new l.AdaptiveDataModel,b.SetAlphabet(_+2),n>this.m_maxNumVectors&&(this.m_maxNumVectors=n,this.m_quantVectors=new Int32Array(this.m_maxNumVectors)),y=this.m_quantVectors,r===u.O3DGC_STREAM_TYPE_ASCII)for(w=0;h>w;++w)for(D=0;c>D;++D)y[D*h+w]=t.ReadIntASCII(i);else for(w=0;h>w;++w)for(D=0;c>D;++D)y[D*h+w]=m.DecodeIntACEGC(b,f,p,v,_);
for(D=0;c>D;++D)this.ITransform(y,D*h,h);return this.IQuantize(e.GetVectors(),h,c,e.GetStride(),e.GetMinArray(),e.GetMaxArray(),this.m_params.GetQuantBits()),a},l}();