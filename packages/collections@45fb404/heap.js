function Heap(e,t,n){return this instanceof Heap?(this.contentEquals=t||Object.equals,this.contentCompare=n||Object.compare,this.content=[],this.length=0,this.addEach(e),void 0):new Heap(e,t,n)}var ArrayChanges=require("./listen/array-changes"),Shim=require("./shim"),GenericCollection=require("./generic-collection"),MapChanges=require("./listen/map-changes"),RangeChanges=require("./listen/range-changes"),PropertyChanges=require("./listen/property-changes");module.exports=Heap,Heap.Heap=Heap,Object.addEach(Heap.prototype,GenericCollection.prototype),Object.addEach(Heap.prototype,PropertyChanges.prototype),Object.addEach(Heap.prototype,RangeChanges.prototype),Object.addEach(Heap.prototype,MapChanges.prototype),Heap.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.contentCompare)},Heap.prototype.push=function(e){this.content.push(e),this.float(this.content.length-1),this.length++},Heap.prototype.pop=function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content.set(0,t),this.sink(0)),this.length--,e},Heap.prototype.add=function(e){this.push(e)},Heap.prototype.indexOf=function(e){for(var t=0;this.length>t;t++)if(this.contentEquals(this.content[t],e))return t;return-1},Heap.prototype["delete"]=function(e,t){if(t)throw Error("Heap#delete does not support second argument: equals");var n=this.indexOf(e);if(-1===n)return!1;var i=this.content.pop();if(n===this.content.length)return!0;this.content.set(n,i);var r=this.contentCompare(i,e);return r>0?this.float(n):0>r&&this.sink(n),this.length--,!0},Heap.prototype.peek=function(){return this.length?this.content[0]:void 0},Heap.prototype.max=function(){return this.peek()},Heap.prototype.one=function(){return this.peek()},Heap.prototype.float=function(e){for(var t=this.content[e];e>0;){var n=Math.floor((e+1)/2)-1,i=this.content[n];if(!(0>this.contentCompare(i,t)))break;this.content.set(n,t),this.content.set(e,i),e=n}},Heap.prototype.sink=function(e){for(var t,n,i,r,a,s,o=this.content.length,l=this.content[e];;){if(r=2*(e+1),i=r-1,s=!1,o>i){var t=this.content[i],c=this.contentCompare(t,l);c>0&&(a=i,s=!0)}if(o>r){var n=this.content[r],c=this.contentCompare(n,s?t:l);c>0&&(a=r,s=!0)}if(!s)break;this.content.set(e,this.content[a]),this.content.set(a,l),e=a}},Heap.prototype.clear=function(){this.content.clear(),this.length=0},Heap.prototype.reduce=function(e,t){var n=arguments[2];return this.content.reduce(function(t,i,r){return e.call(n,t,i,r,this)},t,this)},Heap.prototype.reduceRight=function(e,t){var n=arguments[2];return this.content.reduceRight(function(t,i,r){return e.call(n,t,i,r,this)},t,this)},Heap.prototype.makeObservable=function(){this.content.addRangeChangeListener(this,"content"),this.content.addBeforeRangeChangeListener(this,"content"),this.content.addMapChangeListener(this,"content"),this.content.addBeforeMapChangeListener(this,"content")},Heap.prototype.handleContentRangeChange=function(e,t,n){this.dispatchRangeChange(e,t,n)},Heap.prototype.handleContentRangeWillChange=function(e,t,n){this.dispatchBeforeRangeChange(e,t,n)},Heap.prototype.handleContentMapChange=function(e,t){this.dispatchMapChange(t,e)},Heap.prototype.handleContentMapWillChange=function(e,t){this.dispatchBeforeMapChange(t,e)};