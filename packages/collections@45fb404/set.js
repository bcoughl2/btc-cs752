"use strict";function Set(e,t,n,i){return this instanceof Set?(t=t||Object.equals,n=n||Object.hash,i=i||Function.noop,this.contentEquals=t,this.contentHash=n,this.getDefault=i,this.order=new this.Order(void 0,t),this.store=new this.Store(void 0,function(e,n){return t(e.value,n.value)},function(e){return n(e.value)}),this.length=0,this.addEach(e),void 0):new Set(e,t,n,i)}var Shim=require("./shim"),List=require("./list"),FastSet=require("./fast-set"),GenericCollection=require("./generic-collection"),GenericSet=require("./generic-set"),PropertyChanges=require("./listen/property-changes"),RangeChanges=require("./listen/range-changes");module.exports=Set,Set.Set=Set,Object.addEach(Set.prototype,GenericCollection.prototype),Object.addEach(Set.prototype,GenericSet.prototype),Object.addEach(Set.prototype,PropertyChanges.prototype),Object.addEach(Set.prototype,RangeChanges.prototype),Set.prototype.Order=List,Set.prototype.Store=FastSet,Set.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.contentHash,this.getDefault)},Set.prototype.has=function(e){var t=new this.order.Node(e);return this.store.has(t)},Set.prototype.get=function(e,t){if(t)throw Error("Set#get does not support second argument: equals");var n=new this.order.Node(e);return n=this.store.get(n),n?n.value:this.getDefault(e)},Set.prototype.add=function(e){var t=new this.order.Node(e);if(!this.store.has(t)){var n=this.length;return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([e],[],n),this.order.add(e),t=this.order.head.prev,this.store.add(t),this.length++,this.dispatchesRangeChanges&&this.dispatchRangeChange([e],[],n),!0}return!1},Set.prototype["delete"]=function(e,t){if(t)throw Error("Set#delete does not support second argument: equals");var n=new this.order.Node(e);if(this.store.has(n)){var n=this.store.get(n);return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([],[e],n.index),this.store["delete"](n),this.order.splice(n,1),this.length--,this.dispatchesRangeChanges&&this.dispatchRangeChange([],[e],n.index),!0}return!1},Set.prototype.pop=function(){if(this.length){var e=this.order.head.prev.value;return this["delete"](e),e}},Set.prototype.shift=function(){if(this.length){var e=this.order.head.next.value;return this["delete"](e),e}},Set.prototype.one=function(){return this.length>0?this.store.one().value:void 0},Set.prototype.clear=function(){var e;this.dispatchesRangeChanges&&(e=this.toArray(),this.dispatchBeforeRangeChange([],e,0)),this.store.clear(),this.order.clear(),this.length=0,this.dispatchesRangeChanges&&this.dispatchRangeChange([],e,0)},Set.prototype.reduce=function(e,t){var n=arguments[2],i=this.order,r=0;return i.reduce(function(t,i){return e.call(n,t,i,r++,this)},t,this)},Set.prototype.reduceRight=function(e,t){var n=arguments[2],i=this.order,r=this.length-1;return i.reduceRight(function(t,i){return e.call(n,t,i,r--,this)},t,this)},Set.prototype.iterate=function(){return this.order.iterate()},Set.prototype.log=function(){var e=this.store;return e.log.apply(e,arguments)},Set.prototype.makeObservable=function(){this.order.makeObservable()};