var Bindings=require("frb"),parse=require("frb/parse"),stringify=require("frb/stringify"),expand=require("frb/expand"),Scope=require("frb/scope"),Serializer=require("../serialization").Serializer,Deserializer=require("../serialization").Deserializer;Serializer.defineSerializationUnit("bindings",function(e,t){var r,n=Bindings.getBindings(t),i={};for(var a in n){var s=n[a],o={};if(!("serializable"in s)||s.serializable){var u=s.sourcePath,l=s.sourceSyntax;if(s.source!==t){var c=e.getObjectLabel(s.source),f=new Scope({type:"component",label:c});f.components=e,l=expand(l,f)}var f=new Scope;f.components=e,u=stringify(l,f),s.twoWay?o["<->"]=u:o["<-"]=u,s.converter?o.converter=s.converter:(o.convert=s.convert,o.revert=s.revert),s.trace&&(o.trace=!0),i[a]=o,r=!0}}return r?i:void 0}),Deserializer.defineDeserializationUnit("bindings",function(e,t,r){for(var n in r){var i=r[n];if("object"!=typeof i)throw Error("Binding descriptor must be an object, not "+typeof i);"boundObject"in i?(i.source=e.getObjectByLabel(i.boundObject),i.oneway?i["<-"]=i.boundPropertyPath:i["<->"]=i.boundPropertyPath,delete i.boundObject,delete i.boundObjectPropertyPath,delete i.oneway):i["<<->"]&&(console.warn("WARNING: <<-> in bindings is deprectated, use <-> only, please update now."),i["<->"]=i["<<->"],delete i["<<->"])}Bindings.defineBindings(t,r,{components:e})});